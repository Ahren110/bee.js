!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Bee=t()}}(function(){return function t(e,n,r){function i(a,o){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!o&&c)return c(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";function r(t){t&&(this.prefix=t)}function i(t,e){$(t)&&(e=t,t=e.$tpl),e=e||{};var n,r={$data:this.$data||{},$filters:this.$filters||{},$watchers:this.$watchers||{},$el:this.$el||null,$target:this.$target||null,$tpl:this.$tpl||"<div></div>",$content:null,$parent:null,$root:this,_watchers:{},_assignments:null,_relativePath:[],_isRendered:!1};for(var i in e)i in _&&y(e[i])?(x(r[i],e[i]),r[i]=x(e[i],r[i])):r[i]=e[i];x(this,r),x(this,this.$data),t=t||this.$tpl,n=p.tplParse(t,this.$target,this.$content),this.$el?this.$el.appendChild(n.el):this.$el=n.el,this.$tpl=n.tpl,this.$content=n.content,this.$el.bee=this,this.$content&&v.walk.call(this.$root,this.$content),v.walk.call(this,this.$el);for(var s in this.$watchers)this.$watch(s,this.$watchers[s]);this.$replace(this.$data),this._isRendered=!0,this.$init()}function s(t,e){var n;1===arguments.length?e=t:n=[t],n||(n=y(e)?Object.keys(e):["$data"]);for(var r,i=0;r=n[i];i++)this.$update(r,!0)}var a=t("./env.js").document,o=t("./utils.js"),c=t("./event.js"),u=t("./class.js"),h=t("./directive.js"),l=t("./component.js"),f=t("./watcher.js"),d=t("./directives"),p=t("./dom-utils.js"),v=t("./check-binding.js"),m=t("./scope"),y=o.isObject,g=o.isUndefined,$=o.isPlainObject,j=o.parseKeyPath,b=o.deepSet,x=o.extend,w=o.create,_={$data:1,$filter:1,$watchers:1};x(i,{extend:o.afterFn(u.extend,o.noop,function(t){t.directives=w(this.directives),t.components=w(this.components)})},h,l,{setPrefix:r,prefix:"",doc:a,directives:{},components:{},mount:function(t,e){var n,r=t.nodeType?t:a.getElementById(t),s=this.components[r.tagName.toLowerCase()];return n=s?new s(x({$target:r},e)):new i(r,e)}}),i.setPrefix("b-");for(var k in d)i.directive(k,d[k]);x(i.prototype,c,{$init:o.noop,$get:function(t){var e=new h("$get",{path:t,watch:!1});return e.parse(),e.getValue(this,!1)},$set:function(t,e){var n,r,i,a,o=!1,c=this;return g(t)?this:(1===arguments.length?y(t)?(x(!0,this.$data,t),x(!0,this,t)):this.$data=t:(o=!0,i=m.reformScope(this,t),a=i.path,c=i.vm,r=j(a),n=b(a,e,{}),"$data"===r[0]&&(n=n.$data),x(!0,c.$data,n),x(!0,c,n)),o?s.call(c,a,e):s.call(c,t),this)},$replace:function(t,e){var n,r,i,a=!1,o=this;return g(t)?this:(1===arguments.length?(y(t)&&(Object.keys(this.$data).forEach(function(t){delete this[t]}.bind(this)),x(this,t)),this.$data=t):(a=!0,r=m.reformScope(this,t),i=r.path,o=r.vm,n=j(i),"$data"!==n[0]&&b(i,e,o.$data),b(i,e,o)),a?s.call(o,i,e):s.call(o,t),this)},$update:function(t,e){e=e!==!1;for(var n,r,i,s=j(t.replace(/^\$data\./,""));n=s.join(".");){i=this._watchers[n]||[];for(var a=0,c=i.length;c>a;a++)i[a].update();if(!e)break;s.pop(),s.length||"$data"===n||s.push("$data")}return r=this.$get(t),y(r)&&!o.isArray(r)&&Object.keys(r).forEach(function(e){this.$update(t+"."+e,!1)}.bind(this)),e&&this.$parent&&this._relativePath.forEach(function(t){this.$parent.$update(t)}.bind(this)),o.isArray(r)&&this.$update(t+".length",!1),this},$watch:function(t,e){if(e){var n=e.bind(this);n._originFn=e,f.addWatcher.call(this,new h("$watch",{path:t,update:n}))}},$unwatch:function(t,e){f.unwatch(this,t,e)}}),i.version="0.2.0",e.exports=i},{"./check-binding.js":3,"./class.js":4,"./component.js":5,"./directive.js":6,"./directives":10,"./dom-utils.js":15,"./env.js":16,"./event.js":19,"./scope":21,"./utils.js":23,"./watcher.js":24}],2:[function(t,e,n){},{}],3:[function(t,e,n){"use strict";function r(t){if(t.nodeType===l.FRAGMENT&&(t=t.childNodes),"length"in t&&u.isUndefined(t.nodeType))for(var e=0;e<t.length;e++)r.call(this,t[e]);else{switch(t.nodeType){case l.ELEMENT:break;case l.COMMENT:return;case l.TEXT:return void s.call(this,t)}if("template"===t.nodeName.toLowerCase()&&!t.content)for(t.content=h.createDocumentFragment();t.childNodes[0];)t.content.appendChild(t.childNodes[0]);if(!i.call(this,t)){"template"===t.nodeName.toLowerCase()&&r.call(this,t.content);for(var n,a=t.firstChild;a;)n=a.nextSibling,r.call(this,a),a=n}}}function i(t){for(var e,n,r,i=this.constructor,s=i.prefix,o=i.directive.getDir(t,i.directives,i.components,s),c={},u=0,h=o.length;h>u&&(e=o[u],e.dirs=o,!(n>e.priority));u++)t.removeAttribute(e.nodeName),a.call(this,e),e.terminal&&(r=!0,n=e.priority);return c.dirs=o,r}function s(t){if(c.hasToken(t.nodeValue)){var e,n,r=c.parseToken(t.nodeValue),i=r.textMap,o=t.parentNode,l=this.constructor.directives;i.length>1?(i.forEach(function(e){var n=h.createTextNode(e);o.insertBefore(n,t),s.call(this,n)}.bind(this)),o.removeChild(t)):(e=r[0],n=u.create(e.escape?l.text:l.html),a.call(this,u.extend(n,e,{el:t})))}}function a(t){if(t.replace){var e=t.el;u.isFunction(t.replace)?t.node=t.replace():t.replace&&(t.node=h.createTextNode("")),t.el=t.el.parentNode,t.el.replaceChild(t.node,e)}t.link(this),o.addWatcher.call(this,t)}var o=t("./watcher"),c=t("./token.js"),u=t("./utils"),h=t("./env.js").document,l={ELEMENT:1,ATTR:2,TEXT:3,COMMENT:8,FRAGMENT:11};h.createElement("template"),e.exports={walk:r}},{"./env.js":16,"./token.js":22,"./utils":23,"./watcher":24}],4:[function(t,e,n){var r=t("./utils.js").extend,i={extend:function(t,e){t=t||{};var n=t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)},i=this,s=function(){this.constructor=n};return s.prototype=i.prototype,n.prototype=new s,r(n.prototype,t),r(n,i,e,{__super__:i.prototype}),n}};e.exports=i},{"./utils.js":23}],5:[function(t,e,n){"use strict";function r(t,e,n){var r=this.components=this.components||{};return this.doc.createElement(t),i.isObject(e)&&(e=this.extend(e,n)),r[t]=e}var i=t("./utils.js");n.tag=n.component=r},{"./utils.js":23}],6:[function(t,e,n){"use strict";function r(t,e){var n=this.directives=this.directives||{};return n[t]=new i(t,e)}function i(t,e){this.type=t,a.extend(this,e)}function s(t,e,n,r){r=r||"",e=e||{};var i,s,u,h,d,p=[],v={},m=t.parentNode,y=t.nodeName.toLowerCase();y in n&&t.setAttribute(r+"component",y);for(var g=t.attributes.length-1;g>=0;g--)i=t.attributes[g],s=i.nodeName,u=s.slice(r.length),h={el:t,node:i,nodeName:s,path:i.value},d=null,0===s.indexOf(r)&&u in e?(d=l(e[u]),d.dirName=u):o.hasToken(i.value)?o.parseToken(i.value).forEach(function(t){t.dirName=0===s.indexOf(r)?u:s,p.push(a.extend(l(e.attr),h,t))}):f.test(s)&&(d=a.extend(l(e.attr),{dirName:s.replace(f,""),conditional:!0})),d&&(d.anchor&&!v.start&&(v.start=c.createComment(d.dirName+" start"),m.insertBefore(v.start,t),v.end=c.createComment(d.dirName+" end"),t.nextSibling?m.insertBefore(v.end,t.nextSibling):m.appendChild(v.end)),d.anchors=d.anchor?v:null,p.push(a.extend(d,h)));return p.sort(function(t,e){return e.priority-t.priority}),p}var a=t("./utils.js"),o=t("./token.js"),c=t("./env.js").document,u=t("./parse.js").parse,h=t("./eval.js"),l=a.create;i.prototype={priority:0,link:a.noop,update:a.noop,tearDown:a.noop,terminal:!1,replace:!1,watch:!0,anchor:!1,anchors:null,getNodes:function(){var t=[],e=this.anchors.start.nextSibling;if(this.anchor&&e){for(;e!==this.anchors.end;)t.push(e),e=e.nextSibling;return t}return null},parse:function(){try{this.ast=u(this.path,this.type)}catch(t){this.ast={},t.message='SyntaxError in "'+this.path+'" | '+t.message,console.error(t)}},getValue:function(t,e){e=e!==!1;var n;try{n=h.eval(this.ast,t,this)}catch(r){n="",console.error(r)}return e&&(a.isUndefined(n)||null===n)&&(n=""),n}};var f=/\?$/;i.directive=r,r.getDir=s,e.exports=i},{"./env.js":16,"./eval.js":17,"./parse.js":20,"./token.js":22,"./utils.js":23}],7:[function(t,e,n){"use strict";function r(t,e,n){try{(e in t||"class"===e)&&("style"===e&&t.style.setAttribute?t.style.setAttribute("cssText",n):"class"===e?t.className=n:t[e]="boolean"==typeof t[e]?!0:n)}catch(r){}t.setAttribute(e,n)}function i(t,e){t.removeAttribute(e),delete t[e]}t("../utils.js");e.exports={link:function(){this.dirName===this.type?this.attrs={}:this.update("")},update:function(t){var e=this.el,n={};if(this.dirName===this.type){for(var s in t)r(e,s,t[s]),delete this.attrs[s],n[s]=!0;for(var s in this.attrs)i(e,s);this.attrs=n}else this.conditional?t?r(e,this.dirName,t):i(e,this.dirName):(this.textMap[this.position]=t&&t+"",r(e,this.dirName,this.textMap.join("")))}}},{"../utils.js":23}],8:[function(t,e,n){var r=t("../utils.js");e.exports={priority:-10,watch:!1,link:function(t){var e,n,i,s=this.el,a=this.path,o=t.constructor.components,c=[],u={};if(a in o){if(e=o[a],e===t.constructor)return;c=this.dirs,c=c.filter(function(t){return"attr"==t.type||"with"==t.type}),c.forEach(function(e){var i,s;i=e.path,"with"===e.type||"attr"===e.dirName?(s="$data",r.extend(u,t.$get(i))):(s=e.dirName,u[s]=t.$get(i)),t.$watch(i,function(t){n&&(t=e.textMap?e.textMap.join(""):t,n.$set(s,t))})}),i=s.attributes;for(var h=i.length-1;h>=0;h--)u[i[0].nodeName]=i[0].value;return n=new e({$target:s,$data:r.extend({},e.prototype.$data,u)}),t.$el===s&&(t.$el=n.$el),!0}console.warn("Component: "+a+" not defined! Ignore")}}},{"../utils.js":23}],9:[function(t,e,n){"use strict";var r=t("../dom-utils"),i=t("../check-binding");e.exports={replace:!0,anchor:!0,link:function(t){this.vm=t},update:function(t){var e=this.getNodes(),n=this.anchors.end.parentNode,s=r.createContent(t);i.walk.call(this.vm,s),e.forEach(function(t){n.removeChild(t)}),n.insertBefore(s,this.anchors.end)}}},{"../check-binding":3,"../dom-utils":15}],10:[function(t,e,n){"use strict";var r=t("../env.js").document,i=t("../utils.js"),s=(t("../token.js"),{});s.text={terminal:!0,replace:!0,update:function(t){this.node.nodeValue=i.isUndefined(t)?"":t}},s.html={terminal:!0,replace:!0,link:function(){this.nodes=[]},update:function(t){var e=r.createElement("div");e.innerHTML=i.isUndefined(t)?"":t;for(var n;n=this.nodes.pop();)n.parentNode&&n.parentNode.removeChild(n);for(var s=e.childNodes;n=s[0];)this.nodes.push(n),this.el.insertBefore(n,this.node)}},s["if"]={anchor:!0,link:function(){this.el.content?(this.frag=this.el.content,this.el.parentNode.removeChild(this.el)):(this.frag=r.createDocumentFragment(),this.hide())},update:function(t){t?this.state||this.show():this.state&&this.hide(),this.state=t},show:function(){var t=this.anchors.end;t.parentNode&&t.parentNode.insertBefore(this.frag,t)},hide:function(){var t=this.getNodes();if(t)for(var e=0,n=t.length;n>e;e++)this.frag.appendChild(t[e])}},s.template={priority:1e4,link:function(){for(var t=this.el.childNodes,e=r.createDocumentFragment();t[0];)e.appendChild(t[0]);this.el.content=e}},s.src={update:function(t){this.el.src=t}},s["with"]={},s.repeat=t("./repeat.js"),s.attr=t("./attr.js"),s.model=t("./model.js"),s.style=t("./style.js"),s.on=t("./on.js"),s.component=t("./component.js"),s.content=t("./content.js"),e.exports=s},{"../env.js":16,"../token.js":22,"../utils.js":23,"./attr.js":7,"./component.js":8,"./content.js":9,"./model.js":11,"./on.js":12,"./repeat.js":13,"./style.js":14}],11:[function(t,e,n){"use strict";var r=t("../utils.js"),i=t("../token.js").hasToken,s=t("../event-bind.js");e.exports={teminal:!0,priority:1,link:function(t){var e=this.path;if(!e)return!1;var n,a=this.el,o="change",c=n="value",u=t,h=r.isUndefined(u.$get(e)),l=/\r\n/g,f=function(t){var e=(t||"")+"",t=a[n];t&&t.replace&&(t=t.replace(l,"\n")),e!==t&&(a[n]=e)},d=function(t){var n=a[c];n.replace&&(n=n.replace(l,"\n")),u.$set(e,n)},p=function(t){t&&t.propertyName&&t.propertyName!==n||d.apply(this,arguments)},v=r.ie;switch(a.tagName){default:c=n="innerHTML";case"INPUT":case"TEXTAREA":switch(a.type){case"checkbox":c=n="checked",v&&(o+=" click");break;case"radio":n="checked",v&&(o+=" click"),f=function(t){a.checked=a.value===t+""},h=a.checked;break;default:u.$lazy||("oninput"in a&&(o+=" input"),v&&(o+=" keyup propertychange cut"))}break;case"SELECT":a.multiple&&(d=function(t){for(var n=[],r=0,i=a.options.length;i>r;r++)a.options[r].selected&&n.push(a.options[r].value);u.$set(e,n)},f=function(t){if(t&&t.length)for(var e=0,n=a.options.length;n>e;e++)a.options[e].selected=-1!==t.indexOf(a.options[e].value)}),h=h&&!i(a[c])}this.update=f,o.split(/\s+/g).forEach(function(t){s.removeEvent(a,t,p),s.addEvent(a,t,p)}),a[c]&&h&&d(!0)}}},{"../event-bind.js":18,"../token.js":22,"../utils.js":23}],12:[function(t,e,n){"use strict";function r(t,e,n){return function(r){var i=r.target||r.srcElement,a=e?s.toArray(t.el.querySelectorAll(e)):[i];do if(a.indexOf(i)>=0)return r.delegateTarget=i,n.call(t.vm,r);while(i=i.parentNode)}}var i=t("../event-bind.js"),s=t("../utils");e.exports={watch:!1,link:function(t){this.vm=t},update:function(t){var e,n;for(var s in t)e=s.split(/\s+/),n=e.shift(),e=e.join(" "),i.addEvent(this.el,n,r(this,e,t[s]))}}},{"../event-bind.js":18,"../utils":23}],13:[function(t,e,n){"use strict";function r(t,e){var n=e.slice();return t.filter(function(t){var e,r=n.indexOf(t);return 0>r?e=!0:n.splice(r,1),e})}var i=(t("../env.js").document,t("../utils.js")),s=["splice","push","pop","shift","unshift","sort","reverse"];e.exports={priority:1e3,anchor:!0,terminal:!0,link:function(t){var e=this.cstr=t.constructor;for(this.vm=t;e.__super__;)e=e.__super__.constructor;this.cstr=e.extend({},this.cstr),this.curArr=[],this.list=[],this.el.parentNode.removeChild(this.el)},update:function(t){var e=this.curArr,n=this.anchors.end.parentNode,a=this,o=this.list;i.isArray(t)&&(this.listPath=this.summary.locals.filter(function(t){return!i.isFunction(a.vm.$get(t))}),r(e,t).forEach(function(t){var r=e.indexOf(t);e.splice(r,1),n.removeChild(o[r].el),o.splice(r,1)}),t.forEach(function(r,i){var s,c,u=t.indexOf(r,i),h=e.indexOf(r,i);0>h?(c=this.el.cloneNode(!0),s=new this.cstr(c,{$data:r,_assignments:this.summary.assignments,$index:u,$root:this.vm.$root,$parent:this.vm,__repeat:!0}),n.insertBefore(s.$el,o[u]&&o[u].el||this.anchors.end),o.splice(u,0,{el:c,vm:s}),e.splice(u,0,r),s._relativePath=this.listPath):u!==h&&(n.insertBefore(o[h].el,o[u]&&o[u].el||a.anchor.end),n.insertBefore(o[u].el,o[h+1]&&o[h+1].el||a.anchor.end),o[h]=[o[u],o[u]=o[h]][0],e[h]=[e[u],e[u]=e[h]][0],o[u].vm.$index=u,o[u].vm.$update("$index"))}.bind(this)),this.list.forEach(function(t,e){t.vm.$index=e,t.el.$index=e,t.vm.$update("$index",!1)}),t.__dirs__||(i.extend(t,{$set:function(e,n){t.__dirs__.forEach(function(t){t.list[e].vm.$set(n)})},$replace:function(e,n){t.__dirs__.forEach(function(t){t.list[e].vm.$replace(n)})},$remove:function(e){t.splice(e,1),t.__dirs__.forEach(function(t){t.listPath.forEach(function(e){t.vm.$update(e)})})}}),s.forEach(function(e){t[e]=i.afterFn(t[e],function(){t.__dirs__.forEach(function(t){t.listPath.forEach(function(e){t.vm.$update(e)})})})}),t.__dirs__=[]),-1===t.__dirs__.indexOf(a)&&t.__dirs__.push(a))}}},{"../env.js":16,"../utils.js":23}],14:[function(t,e,n){"use strict";var r=/([A-Z])/g,i=["width","height","margin","margin-top","margin-right","margin-left","margin-bottom","padding","padding-top","padding-right","padding-bottom","padding-left"];e.exports={update:function(t){var e,n,s=this.el,a="";for(var o in t)n=t[o],e=o.replace(r,function(t){return"-"+t.toLowerCase()}),!isNaN(n)&&i.indexOf(e)>=0&&(n+="px"),a+=e+": "+n+"; ";s.style.setAttribute?s.style.setAttribute("cssText",a):s.setAttribute("style",a)}}},{}],15:[function(t,e,n){"use strict";function r(t,e,n){var r;return a.isObject(e)&&e.childNodes?n=i(e.childNodes):n&&(n=i(n)),a.isObject(t)?(r=t,t=r.outerHTML):r=i(t).childNodes[0],e&&e.parentNode&&e.parentNode.replaceChild(r,e),{el:r,tpl:t,content:n}}function i(t){var e,n=s.createDocumentFragment(),r=[];a.isObject(t)?t.nodeName&&t.nodeType?n.appendChild(t):"length"in t&&(r=t):(e=s.createElement("div"),e.innerHTML=(t+"").trim(),r=e.childNodes);for(;r[0];)n.appendChild(r[0]);return n}var s=t("./env.js").document,a=t("./utils");e.exports={tplParse:r,createContent:i}},{"./env.js":16,"./utils":23}],16:[function(t,e,n){!function(e){"use strict";n.root=e,n.document=e.document||t("jsdom").jsdom()}(function(){return this}())},{jsdom:2}],17:[function(t,e,n){"use strict";function r(t,e){return h[t][e]||function(){}}function i(t,e){o=!0,t?(o=!1,s={locals:t||{},filters:t.$filters||{}}):s={filters:{},locals:{}},e&&(u=e),a={filters:{},locals:{},paths:{},assignments:{}},c=""}var s,a,o,c,u,h={unary:{"+":function(t){return+t},"-":function(t){return-t},"!":function(t){return!t},"[":function(t){return t},"{":function(t){for(var e={},n=0,r=t.length;r>n;n++)e[t[n][0]]=t[n][1];return e},"typeof":function(t){return typeof t},"new":function(t){return new t}},binary:{"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"<":function(t,e){return e>t},">":function(t,e){return t>e},"<=":function(t,e){return e>=t},">=":function(t,e){return t>=e},"==":function(t,e){return t==e},"!=":function(t,e){return t!=e},"===":function(t,e){return t===e},"!==":function(t,e){return t!==e},"&&":function(t,e){return t&&e},"||":function(t,e){return t||e},",":function(t,e){return e},".":function(t,e){return e&&(c=c+"."+e),t[e]},"[":function(t,e){return"undefined"!=typeof e&&(c=c+"."+e),t[e]},"(":function(t,e){return t.apply(s.locals,e)},"|":function(t,e){return e.call(s.locals,t)},"new":function(t,e){return t===Date?new Function("return new Date("+e.join(", ")+")")():new(Function.prototype.bind.apply(t,e))},"in":function(t,e){return this.assignment?e:t in e}},ternary:{"?":function(t,e,n){return t?e:n},"(":function(t,e,n){return t[e].apply(t,n)},"|":function(t,e,n){return e.apply(s.locals,[t].concat(n))}}},l=["first","second","third"],f=function(t){for(var e,n,i=t.arity,u=t.value,h=[],p=0;3>p;p++)if(e=t[l[p]])if(Array.isArray(e)){h[p]=[];for(var v=0,m=e.length;m>v;v++)h[p].push("undefined"==typeof e[v].key?f(e[v]):[e[v].key,f(e[v])])}else h[p]=f(e);switch("literal"!==i&&(c&&"."!==u&&"["!==u&&(a.paths[c]=!0),"name"===i&&(c=u)),i){case"unary":case"binary":case"ternary":try{n=r(i,u).apply(t,h)}catch(y){o||console.warn(y)}break;case"literal":n=u;break;case"assignment":a.assignments[u]=!0;break;case"name":a.locals[u]=!0,n=d(u,s.locals);break;case"filter":a.filters[u]=!0,n=s.filters[u];break;case"this":n=s.locals}return n},d=t("./scope").getValue;n.eval=function(t,e,n){return i(e||{},n),f(t)},n.summary=function(t){i(),f(t),c&&(a.paths[c]=!0);for(var e in a)a[e]=Object.keys(a[e]);return a}},{"./scope":21}],18:[function(t,e,n){"use strict";n.addEvent=function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},n.removeEvent=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n):t.detachEvent("on"+e,n)}},{}],19:[function(t,e,n){var r=t("./utils.js"),i={$on:function(t,e,n){var r=n||this;return r._handlers=r._handlers||{},r._handlers[t]=r._handlers[t]||[],r._handlers[t].push({handler:e,context:n,ctx:r}),this},$one:function(t,e,n){return e&&(e.one=!0),this.on(t,e,n)},$off:function(t,e,n){var i=n||this,s=i._handlers;if(t&&s[t])if(r.isFunction(e))for(var a=s[t].length-1;a>=0;a--)s[t][a].handler===e&&s[t].splice(a,1);else s[t]=[];return this},$trigger:function(t,e){var n=[].slice.call(arguments,1),r=this._handlers&&this._handlers[t];if(r)for(var i,s=0;i=r[s];s++)i.handler.apply(this,n),i.handler.one&&(r.splice(s,1),s--);return this}};e.exports=i},{"./utils.js":23}],20:[function(t,e,n){"use strict";var r,i=Object.create||function(t){function e(){}return e.prototype=t,new e},s=function(t,e){e=e||this;var n=t+=" But found '"+e.value+"'"+(e.from?" at "+e.from:"")+" in '"+r+"'",i=new Error(n);throw i.name=e.name="SyntaxError",e.message=t,i},a=function(t,e,n){var r,i,a,o,c,u=0,h=t.length,l=[],f=function(t,e){return{type:t,value:e,from:i,to:u}};if(t){for(r=t.charAt(u);r;)if(i=u," ">=r)u+=1,r=t.charAt(u);else if(r>="a"&&"z">=r||r>="A"&&"Z">=r||"$"===r||"_"===r){for(c=r,u+=1;r=t.charAt(u),r>="a"&&"z">=r||r>="A"&&"Z">=r||r>="0"&&"9">=r||"_"===r;)c+=r,u+=1;l.push(f("name",c))}else if(r>="0"&&"9">=r){for(c=r,u+=1;r=t.charAt(u),!("0">r||r>"9");)u+=1,c+=r;if("."===r)for(u+=1,c+=r;r=t.charAt(u),!("0">r||r>"9");)u+=1,c+=r;if("e"===r||"E"===r){u+=1,c+=r,r=t.charAt(u),("-"===r||"+"===r)&&(u+=1,c+=r,r=t.charAt(u)),("0">r||r>"9")&&s("Bad exponent",f("number",c));do u+=1,c+=r,r=t.charAt(u);while(r>="0"&&"9">=r)}r>="a"&&"z">=r&&(c+=r,u+=1,s("Bad number",f("number",c))),a=+c,isFinite(a)?l.push(f("number",a)):s("Bad number",f("number",c))}else if("'"===r||'"'===r){for(c="",o=r,u+=1;r=t.charAt(u)," ">r&&(f("string",c),s("\n"===r||"\r"===r||""===r?"Unterminated string.":"Control character in string.",f("",c))),r!==o;){if("\\"===r)switch(u+=1,u>=h&&s("Unterminated string",f("string",c)),r=t.charAt(u)){case"b":r="\b";break;case"f":r="\f";break;case"n":r="\n";break;case"r":r="\r";break;case"t":r="	";break;case"u":u>=h&&s("Unterminated string",f("string",c)),r=parseInt(t.substr(u+1,4),16),(!isFinite(r)||0>r)&&s("Unterminated string",f("string",c)),r=String.fromCharCode(r),u+=4}c+=r,u+=1}u+=1,l.push(f("string",c)),r=t.charAt(u)}else if(e.indexOf(r)>=0){for(c=r,u+=1;;){if(r=t.charAt(u),u>=h||n.indexOf(r)<0)break;c+=r,u+=1}l.push(f("operator",c))}else u+=1,l.push(f("operator",r)),r=t.charAt(u);return l}},o=function(t){t=t||{};var e,n,o,c,u={},h=function(){return this},l=function(t){return t.nud=h,t.led=null,t.std=null,t.lbp=0,t},f=function(t){var r,a,c,h;return t&&e.id!==t&&s("Expected '"+t+"'.",e),o>=n.length?void(e=u["(end)"]):(c=n[o],o+=1,h=c.value,r=c.type,("operator"===r||"string"!==r)&&h in u?(a=u[h],a||s("Unknown operator.",c)):"name"===r?a=l(c):"string"===r||"number"===r||"regexp"===r?(a=u["(literal)"],r="literal"):s("Unexpected token.",c),e=i(a),e.from=c.from,e.to=c.to,e.value=h,e.arity=r,e)},d=function(t){var n,r=e;for(f(),n=r.nud();t<e.lbp;)r=e,f(),n=r.led(n);return n},p={nud:function(){s("Undefined.",this)},led:function(t){s("Missing operator.",this)}},v=function(t,e){var n=u[t];return e=e||0,n?e>=n.lbp&&(n.lbp=e):(n=i(p),n.id=n.value=t,n.lbp=e,u[t]=n),n},m=function(t,e,n){var r=v(t);return r.nud=function(){return this.value=u[this.id].value,this.arity="literal",this},r.value=e,r},y=function(t,e,n){var r=v(t,e);return r.led=n||function(t){return this.first=t,this.second=d(e),this.arity="binary",this},r},g=function(t,e,n){var r=v(t,e);return r.led=n||function(t){return this.first=t,this.second=d(e-1),this.arity="binary",this},r},$=function(t,e){var n=v(t);return n.nud=e||function(){return this.first=d(70),this.arity="unary",this},n};v("(end)"),v("(name)"),v(":"),v(")"),v("]"),v("}"),v(","),m("true",!0),m("false",!1),m("null",null),m("undefined"),m("Math",Math),m("Date",Date);for(var j in t)m(j,t[j]);return v("(literal)").nud=h,v("this").nud=function(){return this.arity="this",this},y(",",1),y("?",20,function(t){return this.first=t,this.second=d(0),f(":"),this.third=d(0),this.arity="ternary",this}),g("&&",31),g("||",30),g("===",40),g("!==",40),g("==",40),g("!=",40),g("<",40),g("<=",40),g(">",40),g(">=",40),y("in",45,function(t){return this.first=t,this.second=d(0),this.arity="binary","repeat"===c&&(t.arity="assignment",this.assignment=!0),this}),y("+",50),y("-",50),y("*",60),y("/",60),y("%",60),y("(",70,function(t){var n=[];if("."===t.id||"["===t.id?(this.arity="ternary",this.first=t.first,this.second=t.second,this.third=n):(this.arity="binary",this.first=t,this.second=n,"unary"===t.arity&&"function"===t.id||"name"===t.arity||"literal"===t.arity||"("===t.id||"&&"===t.id||"||"===t.id||"?"===t.id||s("Expected a variable name.",t)),")"!==e.id)for(;;){if(n.push(d(1)),","!==e.id)break;f(",")}return f(")"),this}),y(".",80,function(t){return this.first=t,"name"!==e.arity&&s("Expected a property name.",e),e.arity="literal",this.second=e,this.arity="binary",f(),this}),y("[",80,function(t){return this.first=t,this.second=d(0),this.arity="binary",f("]"),this}),y("|",10,function(t){var n;if(this.first=t,e.arity="filter",this.second=d(10),this.arity="binary",":"===e.id)for(this.arity="ternary",this.third=n=[];;)if(f(":"),n.push(d(0)),":"!==e.id)break;return this}),$("!"),$("-"),$("typeof"),$("(",function(){var t=d(0);return f(")"),t}),$("[",function(){var t=[];if("]"!==e.id)for(;;){if(t.push(d(1)),","!==e.id)break;f(",")}return f("]"),this.first=t,this.arity="unary",this}),$("{",function(){var t,n,r=[];if("}"!==e.id)for(;;){if(t=e,"name"!==t.arity&&"literal"!==t.arity&&s("Bad property name: ",e),f(),f(":"),n=d(1),n.key=t.value,r.push(n),","!==e.id)break;f(",")}return f("}"),this.first=r,this.arity="unary",this}),$("new",function(){var t=[];if(this.first=d(79),"("===e.id){for(f("("),this.arity="binary",this.second=t;;){if(t.push(d(1)),","!==e.id)break;f(",")}f(")")}else this.arity="unary";return this}),function(t,e){r=t,n=a(t,"=<>!+-*&|/%^","=<>&|"),o=0,c=e,f();var i=d(0);return f("(end)"),i}};n.parse=o()},{}],21:[function(t,e,n){"use strict";var r=t("./utils"),i=function(t,e){for(var n,i=r.parseKeyPath(e),s=t,a=i[0],o=s,c=s;s;){if(c=o=s,n=s._assignments,s.__repeat)if(n&&n.length){if("$index"===a||"$parent"===a)break;if(a===n[0]){o={},o[e]=s.$data,1===i.length?a="$data":i.shift();break}}else if(e in s)break;s=s.$parent}return{scope:o,vm:c,path:i.join(".")}},s=function(t,e){var n=i(e,t);return n.scope[n.path]};n.reformScope=i,n.getValue=s},{"./utils":23}],22:[function(t,e,n){function r(t){return s.lastIndex=0,t&&s.test(t)}function i(t){var e,n,r=[],i=[],a=0;for(s.lastIndex=0;e=s.exec(t);)s.lastIndex-a>e[0].length&&i.push(t.slice(a,s.lastIndex-e[0].length)),n={escape:!e[2],path:(e[2]||e[1]).trim(),position:i.length,textMap:i},r.push(n),i.push(e[0]),a=s.lastIndex;return t.length>a&&i.push(t.slice(a,t.length)),r.textMap=i,r}var s=/{{({([^}\n]+)}|[^}\n]+)}}/g;n.hasToken=r,n.parseToken=i},{}],23:[function(t,e,n){"use strict";function r(t){return t.replace(o,"").split(a)}function i(){var t,e,n,r,s,a,o=arguments[0]||{},c=1,h=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[c]||{},c++),u.isFunction(arguments[h-1])&&h--,"object"==typeof o||u.isFunction(o)||(o={});h>c;c++)if(null!=(t=arguments[c]))for(e in t)if(t.hasOwnProperty(e)&&"prototype"!==e)if(n=o[e],r=t[e],l&&r&&(u.isPlainObject(r)||(s=u.isArray(r)))){if(o===r)continue;s?(s=!1,a=n&&u.isArray(n)?n:[]):a=n&&u.isPlainObject(n)?n:{},o[e]=i(l,a,r)}else u.isUndefined(r)||"string"==typeof o||(o[e]=r);return o}var s=t("./env.js").document,a=/(?:\.|\[)/g,o=/\]/g,c=Object.create||function(t){function e(){}return e.prototype=t,new e},u={noop:function(){},ie:!!s.attachEvent,isObject:function(t){return"object"==typeof t&&null!==t},isUndefined:function(t){return"undefined"==typeof t},isFunction:function(t){return"function"==typeof t},isArray:function(t){return u.ie?t&&t.constructor+""==Array+"":Array.isArray(t)},isPlainObject:function(t){return!t||"[object Object]"!=={}.toString.call(t)||t.nodeType||t===t.window?!1:!0},beforeFn:function(t,e,n){return function(){var r=e.apply(this,arguments);return n&&n.call(this,r)?r:t.apply(this,arguments)}},afterFn:function(t,e,n){return function(){var r=t.apply(this,arguments);return n&&n.call(this,r)?r:(e.apply(this,arguments),r)}},parseKeyPath:r,deepSet:function(t,e,n){if(t){var s=r(t),a=n;s.forEach(function(t,n){n===s.length-1?a[t]=e:a&&a.hasOwnProperty(t)?a=a[t]:(a[t]={},a=a[t])})}else i(n,e);return n},extend:i,create:c,toArray:function(t){var e=[];try{e=Array.prototype.slice.call(t)}catch(n){for(var r=0,i=t.length;i>r;r++)e[r]=t[r]}return e}};e.exports=u},{"./env.js":16}],24:[function(t,e,n){"use strict";function r(t,e){var n,r,i=t;this.dir=e,this.vm=t,this.val=0/0,e.parse(),e.summary=o.summary(e.ast);for(var s=0,a=e.summary.paths.length;a>s;s++)n=h(t,e.summary.paths[s]),i=n.vm,r=n.path,e.watch&&(i._watchers[r]=i._watchers[r]||[],i._watchers[r].push(this));this.update()}function i(t,e,n){var r;try{r=o.summary(u(e))}catch(i){i.message='SyntaxError in "'+e+'" | '+i.message,console.error(i)}r.paths.forEach(function(e){for(var r,i=t._watchers[e]||[],s=i.length-1;s>=0;s--)r=i[s].dir.update,(r===n||r._originFn===n)&&i.splice(s,1)})}function s(t){return t.path?new r(this,t):void 0}function a(t){try{this.dir.update(t,this.val),this.val=t}catch(e){console.error(e)}}var o=t("./eval.js"),c=t("./utils.js"),u=t("./parse.js").parse,h=t("./scope").reformScope;r.unwatch=i,r.addWatcher=s,c.extend(r.prototype,{update:function(){var t,e=this;t=this.dir.getValue(this.vm),t&&t.then?t.then(function(t){a.call(e,t)}):a.call(this,t)}}),e.exports=r},{"./eval.js":17,"./parse.js":20,"./scope":21,"./utils.js":23}]},{},[1])(1)});
//# sourceMappingURL=bee.min.js.map