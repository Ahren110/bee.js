{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/bee.js","bee.js","src/check-binding.js","src/class.js","src/component.js","src/directive.js","src/directives/attr.js","src/directives/component.js","src/directives/content.js","src/directives/index.js","src/directives/model.js","src/directives/on.js","src/directives/repeat.js","src/directives/style.js","src/dom-utils.js","src/env.js","src/eval.js","src/event-bind.js","src/event.js","src/parse.js","src/scope.js","src/token.js","src/utils.js","src/watcher.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","Bee","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"setPrefix","newPrefix","prefix","tpl","props","isPlainObject","$tpl","el","defaults","$data","$filters","$watchers","$el","$target","$content","$parent","$root","_watchers","_assignments","_relativePath","__links","_isRendered","propKey","mergeProps","isObject","extend","domUtils","tplParse","appendChild","content","bee","checkBinding","walk","concat","key","$watch","$replace","$init","update","keyPath","data","keyPaths","arguments","Object","keys","path","$update","doc","document","utils","Event","Class","Dir","Com","Watcher","dirs","scope","isUndefined","parseKeyPath","deepSet","create","$filter","afterFn","noop","sub","directives","components","mount","id","instance","nodeType","getElementById","Comp","tagName","toLowerCase","dir","directive","prototype","$destroy","$get","watch","parse","getValue","$set","val","add","reformed","reKey","hasKey","reVm","reformScope","vm","forEach","bind","isBubble","attrs","watchers","replace","join","pop","push","isArray","attr","callback","_originFn","addWatcher","$unwatch","unwatch","__destroy","wacher","version","./check-binding.js","./class.js","./component.js","./directive.js","./directives","./dom-utils.js","./env.js","./event.js","./scope","./utils.js","./watcher.js",2,3,"dirResult","NODETYPE","FRAGMENT","childNodes","ELEMENT","COMMENT","TEXT","checkText","nodeName","createDocumentFragment","checkAttr","terminal","next","child","firstChild","nextSibling","terminalPriority","cstr","constructor","getDir","result","priority","removeAttribute","setBinding","node","token","hasToken","nodeValue","tokens","parseToken","textMap","parentNode","text","tn","createTextNode","insertBefore","removeChild","escape","html","watcher","isFunction","replaceChild","link","unBinding","ATTR","createElement","./token.js","./utils","./watcher",4,"protoProps","staticProps","hasOwnProperty","sup","apply","Fn","__super__",5,"tag","Component","statics","tags","component",6,"opts","Directive","type","attrName","dirName","proto","anchors","parent","setAttribute","attributes","slice","value","indexOf","origin","attrPostReg","test","conditional","anchor","start","createComment","end","sort","d0","d1","evaluate","unLink","tearDown","getNodes","nodes","ast","message","console","error","forgive","eval","./eval.js","./parse.js",7,"setAttr","style","className","removeAttr","newAttrs","position","../utils.js",8,"comp","comName","filter","curPath","comPath","__ref","warn",9,"createContent","../check-binding","../dom-utils",10,"innerHTML","frag","hide","state","show","template","src","repeat","model","on","../env.js","../token.js","./attr.js","./content.js","./model.js","./on.js","./repeat.js","./style.js",11,"events","teminal","ev","ant","isSetDefaut","crlf","newVal","handler","isInit","callHandler","propertyName","ie","checked","$lazy","multiple","vals","options","selected","split","removeEvent","addEvent","../event-bind.js",12,"selector","cur","target","srcElement","els","toArray","querySelectorAll","delegateTarget","eventBind","eventType","name","shift","../utils",13,"arrDiff","arr1","arr2","arr2Copy","index","splice","arrayMethods","curArr","list","items","that","listPath","summary","locals","item","pos","oldPos","cloneNode","assignments","$index","__repeat","__dirs__","$remove","method",14,"camelReg","pixelAttrs","styles","dashKey","styleStr","upperChar","isNaN",15,"outerHTML","wraper","trim",16,"root","jsdom",17,"getOperator","arity","operators","reset","summaryCall","context","filters","paths","unary","+","v","-","!","[","{","typeof","new","binary","*","/","%","<",">","<=",">=","==","!=","===","!==","&&","||",",",".","(","|","Date","Function","in","assignment","ternary","?","argName","tree","arg","res","args","Array",18,"event","addEventListener","attachEvent","removeEventListener","detachEvent",19,"$on","ctx","_handlers","$one","one","$off","handlers","$trigger",20,"source","F","msg","from","tokenize","suffix","c","q","str","make","to","charAt","isFinite","parseInt","substr","String","fromCharCode","make_parse","vars","token_nr","symbol_table","itself","find","nud","led","std","lbp","advance","expression","rbp","left","original_symbol","symbol","bp","constant","x","infix","first","second","infixr","Math","third","_source","_context",21,"ass","local","curVm",22,"tokenReg","lastIndex","exec",23,"bra","keyPathReg","copy","copyIsArray","clone","deep","toString","beforeFn","oriFn","fn","breakCheck","ret","keyStr","obj","chain","arrLike","arr",24,"NaN","exp","watcherUpdate","then"],"mappings":"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","file":"bee.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\n\nvar doc = require('./env.js').document\n  , utils = require('./utils.js')\n  , Event = require('./event.js')\n  , Class = require('./class.js')\n  , Dir = require('./directive.js')\n  , Com = require('./component.js')\n  , Watcher = require('./watcher.js')\n\n  , dirs = require('./directives')\n  , domUtils = require('./dom-utils.js')\n  , checkBinding = require('./check-binding.js')\n  , scope = require('./scope')\n  ;\n\n\nvar isObject = utils.isObject\n  , isUndefined = utils.isUndefined\n  , isPlainObject = utils.isPlainObject\n  , parseKeyPath = utils.parseKeyPath\n  , deepSet = utils.deepSet\n  , extend = utils.extend\n  , create = utils.create\n  ;\n\n//设置 directive 前缀\nfunction setPrefix(newPrefix) {\n  if(newPrefix){\n    this.prefix = newPrefix;\n  }\n}\n\nvar mergeProps = {\n  $data: 1, $filter: 1, $watchers: 1\n};\n\n/**\n * 构造函数\n * ---\n * @param {String|Element} [tpl] 模板. 等同于 props.$tpl\n * @param {Object} [props] 属性/方法\n **/\nfunction Bee(tpl, props) {\n  if(isPlainObject(tpl)) {\n    props = tpl;\n    tpl = props.$tpl;\n  }\n  props = props || {};\n\n  var defaults = {\n    //$ 开头的是共有属性/方法\n    $data: this.$data || {}\n  , $filters: this.$filters || {}\n  , $watchers: this.$watchers || {}\n\n  , $el: this.$el || null\n  , $target: this.$target || null\n  , $tpl: this.$tpl || '<div></div>'\n  , $content: null\n  , $parent: null\n  , $root: this\n\n    //私有属性/方法\n  , _watchers: {}\n  , _assignments: null//当前 vm 的别名\n  , _relativePath: []\n  , __links: []\n  , _isRendered: false\n  };\n\n  var el;\n\n  //保持对传入属性的引用\n  for(var propKey in props) {\n    if((propKey in mergeProps) && isObject(props[propKey])) {\n      //mergeProps 中的属性会被默认值扩展\n      extend(defaults[propKey], props[propKey])\n      defaults[propKey] = extend(props[propKey], defaults[propKey]);\n    }else{\n      defaults[propKey] = props[propKey];\n    }\n  }\n\n  //合并所有到当前空间下\n  extend(this, defaults);\n  isObject(this.$data) && extend(this, this.$data);\n\n  tpl = tpl || this.$tpl;\n  el = domUtils.tplParse(tpl, this.$target, this.$content);\n\n  if(this.$el){\n    this.$el.appendChild(el.el);\n  }else{\n    this.$el = el.el;\n  }\n  this.$tpl = el.tpl;\n  this.$content = el.content;\n\n  this.$el.bee = this;\n\n  if(this.$content){\n    this.__links = checkBinding.walk.call(this.$root, this.$content);\n  }\n  this.__links = this.__links.concat( checkBinding.walk.call(this, this.$el) );\n\n  for(var key in this.$watchers) {\n    this.$watch(key, this.$watchers[key])\n  }\n\n  this.$replace(this.$data);\n  this._isRendered = true;\n  this.$init();\n}\n\n//静态属性\nextend(Bee, {extend: utils.afterFn(Class.extend, utils.noop, function(sub) {\n  //每个构造函数都有自己的 directives 和 components 引用\n  sub.directives = create(this.directives);\n  sub.components = create(this.components);\n})}, Dir, Com, {\n  setPrefix: setPrefix\n, prefix: ''\n, doc: doc\n, directives: {}\n, components: {}\n, mount: function(id, props) {\n    var el = id.nodeType ? id : doc.getElementById(id);\n    var Comp = this.components[el.tagName.toLowerCase()];\n    var instance\n    if(Comp) {\n      instance = new Comp(extend({$target: el}, props))\n    }else{\n      instance = new Bee(el, props);\n    }\n    return instance\n  }\n});\n\n\nBee.setPrefix('b-');\n\n//内置 directive\nfor(var dir in dirs) {\n  Bee.directive(dir, dirs[dir]);\n}\n\n//实例方法\n//----\nextend(Bee.prototype, Event, {\n  $init: utils.noop\n, $destroy: utils.noop\n  /**\n   * 获取属性/方法--\n   * @param {String} keyPath 路径/表达式\n   * @return {*}\n   */\n, $get: function(keyPath) {\n    var dir = new Dir('$get', {\n      path: keyPath\n    , watch: false\n    });\n    dir.parse();\n    return dir.getValue(this, false)\n  }\n\n  /**\n   * ### bee.$set\n   * 更新合并 `.data` 中的数据. 如果只有一个参数, 那么这个参数将并入 .$data\n   * @param {String} [key] 数据路径.\n   * @param {AnyType|Object} val 数据内容.\n   */\n, $set: function(key, val) {\n    var add, keys, hasKey = false;\n    var reformed, reKey, reVm = this;\n    if(isUndefined(key)){ return this; }\n\n    if(arguments.length === 1){\n      if(isObject(key)) {\n        extend(true, this.$data, key);\n        extend(true, this, key);\n      }else{\n        this.$data = key;\n      }\n    }else{\n      hasKey = true;\n      reformed = scope.reformScope(this, key)\n      reKey = reformed.path;\n      reVm = reformed.vm;\n      keys = parseKeyPath(reKey);\n      add = deepSet(reKey, val, {});\n      if(keys[0] === '$data') {\n        add = add.$data\n      }\n      extend(true, reVm.$data, add);\n      extend(true, reVm, add);\n    }\n    hasKey ? update.call(reVm, reKey, val) : update.call(reVm, key);\n    return this;\n  }\n  /**\n   * 数据替换\n   */\n, $replace: function (key, val) {\n    var keys, hasKey = false;\n    var reformed, reKey, reVm = this;\n\n    if(isUndefined(key)){ return this; }\n\n    if(arguments.length === 1){\n      if(isObject(key)) {\n        Object.keys(this.$data).forEach(function(key) {\n          delete this[key];\n        }.bind(this))\n        extend(this, key);\n      }\n      this.$data = key;\n    }else{\n      hasKey = true;\n      reformed = scope.reformScope(this, key)\n      reKey = reformed.path;\n      reVm = reformed.vm;\n      keys = parseKeyPath(reKey);\n      if(keys[0] !== '$data') {\n        deepSet(reKey, val, reVm.$data);\n      }\n      deepSet(reKey, val, reVm);\n    }\n    hasKey ? update.call(reVm, reKey, val) : update.call(reVm, key);\n    return this;\n  }\n  /**\n   * 手动更新某部分数据\n   * @param {String} keyPath 指定更新数据的 keyPath\n   * @param {Boolean} [isBubble=true] 是否更新 keyPath 的父级\n   */\n, $update: function (keyPath, isBubble) {\n    isBubble = isBubble !== false;\n\n    var keys = parseKeyPath(keyPath.replace(/^\\$data\\./, '')), key, attrs;\n    var watchers;\n\n    while(key = keys.join('.')) {\n      watchers = this._watchers[key] || [];\n\n      for (var i = 0, l = watchers.length; i < l; i++) {\n        watchers[i].update();\n      }\n\n      if(isBubble) {\n        keys.pop();\n        //最终都冒泡到 $data\n        if(!keys.length && key !== '$data'){\n          keys.push('$data');\n        }\n      }else{\n        break;\n      }\n    }\n\n    attrs = this.$get(keyPath);\n\n    //同时更新子路径\n    if(isObject(attrs) && !utils.isArray(attrs)) {\n      Object.keys(attrs).forEach(function(attr) {\n        this.$update(keyPath + '.' + attr, false);\n      }.bind(this))\n    }\n\n    if(isBubble) {\n      if(this.$parent) {\n        //同步更新父 vm 对应部分\n        this._relativePath.forEach(function (path) {\n          this.$parent.$update(path);\n        }.bind(this))\n      }\n    }\n\n    //更新数组长度\n    if(utils.isArray(attrs)) {\n      this.$update(keyPath + '.length', false);\n    }\n\n    return this;\n  }\n, $watch: function (keyPath, callback) {\n    if(callback) {\n      var update = callback.bind(this);\n      update._originFn = callback;\n      Watcher.addWatcher.call(this, new Dir('$watch', {path: keyPath, update: update}))\n    }\n    return this;\n  }\n, $unwatch: function (keyPath, callback) {\n    Watcher.unwatch(this, keyPath, callback)\n    return this;\n  }\n, __destroy: function() {\n    this.__links.forEach(function(wacher) {\n      wacher.unwatch()\n    })\n    this.__links = [];\n    this.$destroy()\n  }\n});\n\nfunction update (keyPath, data) {\n  var keyPaths;\n\n  if(arguments.length === 1) {\n    data = keyPath;\n  }else{\n    keyPaths = [keyPath];\n  }\n\n  if(!keyPaths) {\n    if(isObject(data)) {\n      keyPaths = Object.keys(data);\n    }else{\n      //.$data 有可能是基本类型数据\n      keyPaths = ['$data'];\n    }\n  }\n\n  for(var i = 0, path; path = keyPaths[i]; i++){\n    this.$update(path, true);\n  }\n\n}\n\nBee.version = '0.2.0';\n\nmodule.exports = Bee;\n",null,"\"use strict\";\r\n\r\nvar Watcher = require('./watcher')\r\n  , token = require('./token.js')\r\n  , utils = require('./utils')\r\n  , doc = require('./env.js').document\r\n  ;\r\n\r\nvar NODETYPE = {\r\n    ELEMENT: 1\r\n  , ATTR: 2\r\n  , TEXT: 3\r\n  , COMMENT: 8\r\n  , FRAGMENT: 11\r\n};\r\n\r\ndoc.createElement('template')\r\n\r\n//遍历 dom 树\r\nfunction walk(el) {\r\n  var watchers = [], dirResult;\r\n  if(el.nodeType === NODETYPE.FRAGMENT) {\r\n    el = el.childNodes;\r\n  }\r\n\r\n  if(('length' in el) && utils.isUndefined(el.nodeType)){\r\n    //node list\r\n    //对于 nodelist 如果其中有包含 {{text}} 直接量的表达式, 文本节点会被分割, 其节点数量可能会动态增加\r\n    for(var i = 0; i < el.length; i++) {\r\n      watchers = watchers.concat( walk.call(this, el[i]) );\r\n    }\r\n    return watchers;\r\n  }\r\n\r\n  switch (el.nodeType) {\r\n    case NODETYPE.ELEMENT:\r\n      break;\r\n    case NODETYPE.COMMENT:\r\n      //注释节点\r\n      return watchers;\r\n      break;\r\n    case NODETYPE.TEXT:\r\n      //文本节点\r\n      watchers = watchers.concat( checkText.call(this, el) );\r\n      return watchers;\r\n  }\r\n\r\n  if(el.nodeName.toLowerCase() === 'template') {\r\n    //template shim\r\n    if(!el.content) {\r\n      el.content = doc.createDocumentFragment();\r\n      while(el.childNodes[0]) {\r\n        el.content.appendChild(el.childNodes[0])\r\n      }\r\n    }\r\n  }\r\n\r\n  dirResult = checkAttr.call(this, el);\r\n  watchers = watchers.concat(dirResult.watchers)\r\n  if(dirResult.terminal){\r\n    return watchers;\r\n  }\r\n\r\n  if(el.nodeName.toLowerCase() === 'template') {\r\n    watchers = watchers.concat( walk.call(this, el.content) )\r\n  }\r\n\r\n  for(var child = el.firstChild, next; child; ){\r\n    next = child.nextSibling;\r\n    watchers = watchers.concat( walk.call(this, child) );\r\n    child = next;\r\n  }\r\n\r\n  return watchers\r\n}\r\n\r\n//遍历属性\r\nfunction checkAttr(el) {\r\n  var cstr = this.constructor\r\n    , prefix = cstr.prefix\r\n    , dirs = cstr.directive.getDir(el, cstr.directives, cstr.components, prefix)\r\n    , dir\r\n    , terminalPriority, watchers = []\r\n    , result = {};\r\n  ;\r\n\r\n  for (var i = 0, l = dirs.length; i < l; i++) {\r\n    dir = dirs[i];\r\n    dir.dirs = dirs;\r\n\r\n    //对于 terminal 为 true 的 directive, 在解析完其相同权重的 directive 后中断遍历该元素\r\n    if(terminalPriority > dir.priority) {\r\n      break;\r\n    }\r\n\r\n    el.removeAttribute(dir.nodeName);\r\n\r\n    watchers = watchers.concat( setBinding.call(this, dir) );\r\n\r\n    if(dir.terminal) {\r\n      result.terminal = true;\r\n      terminalPriority = dir.priority;\r\n    }\r\n  }\r\n\r\n  result.watchers = watchers\r\n\r\n  return result\r\n}\r\n\r\n//处理文本节点中的绑定占位符({{...}})\r\nfunction checkText(node) {\r\n  var watchers = [];\r\n  if(token.hasToken(node.nodeValue)) {\r\n    var tokens = token.parseToken(node.nodeValue)\r\n      , textMap = tokens.textMap\r\n      , el = node.parentNode\r\n      , dirs = this.constructor.directives\r\n      , t, dir\r\n      ;\r\n\r\n    //将{{key}}分割成单独的文本节点\r\n    if(textMap.length > 1) {\r\n      textMap.forEach(function(text) {\r\n        var tn = doc.createTextNode(text);\r\n        el.insertBefore(tn, node);\r\n        watchers = watchers.concat(checkText.call(this, tn));\r\n      }.bind(this));\r\n      el.removeChild(node);\r\n    }else{\r\n      t = tokens[0];\r\n      //内置各占位符处理.\r\n      dir = utils.create(t.escape ? dirs.text : dirs.html);\r\n      watchers = setBinding.call(this, utils.extend(dir, t, {\r\n        el: node\r\n      }));\r\n    }\r\n  }\r\n  return watchers\r\n}\r\n\r\nfunction setBinding(dir) {\r\n  var watcher\r\n  if(dir.replace) {\r\n    var el = dir.el;\r\n    if(utils.isFunction(dir.replace)) {\r\n      dir.node = dir.replace();\r\n    }else if(dir.replace){\r\n      dir.node = doc.createTextNode('');\r\n    }\r\n\r\n    dir.el = dir.el.parentNode;\r\n    dir.el.replaceChild(dir.node, el);\r\n  }\r\n\r\n  dir.link(this);\r\n\r\n  watcher = Watcher.addWatcher.call(this, dir)\r\n  return watcher ? [watcher] : []\r\n}\r\n\r\nfunction unBinding(watchers) {\r\n  watchers.forEach(function(watcher) {\r\n    watcher.unwatch()\r\n  })\r\n}\r\n\r\nmodule.exports = {\r\n  walk: walk,\r\n  unBinding: unBinding\r\n};\r\n","var extend = require('./utils.js').extend;\n\nvar Class = {\n  /** \n   * 构造函数继承. \n   * 如: `var Car = Bee.extend({drive: function(){}}); new Car();`\n   * @param {Object} [protoProps] 子构造函数的扩展原型对象\n   * @param {Object} [staticProps] 子构造函数的扩展静态属性\n   * @return {Function} 子构造函数\n   */\n  extend: function (protoProps, staticProps) {\n    protoProps = protoProps || {};\n    var constructor = protoProps.hasOwnProperty('constructor') ? protoProps.constructor : function(){ return sup.apply(this, arguments); }\n    var sup = this;\n    var Fn = function() { this.constructor = constructor; };\n    \n    Fn.prototype = sup.prototype;\n    constructor.prototype = new Fn();\n    extend(constructor.prototype, protoProps);\n    extend(constructor, sup, staticProps, {__super__: sup.prototype});\n    \n    return constructor;\n  }\n};\n\nmodule.exports = Class;","\"use strict\";\n\nvar utils = require('./utils.js');\n\n/**\n * 注册组件\n * @param {String} tagName 自定义组件的标签名\n * @param {Function|props} Component 自定义组件的构造函数 / 构造函数参数\n * @return {Function} 自定义组件的构造函数\n */\nfunction tag(tagName, Component, statics) {\n  var tags = this.components = this.components || {};\n\n  this.doc.createElement(tagName);//for old IE\n\n  if(utils.isObject(Component)) {\n    Component = this.extend(Component, statics);\n  }\n  return tags[tagName] = Component;\n}\n\nexports.tag = exports.component = tag;\n","\"use strict\";\n\nvar utils = require('./utils.js')\n  , token = require('./token.js')\n  , doc = require('./env.js').document\n  , parse = require('./parse.js').parse\n  , evaluate = require('./eval.js')\n\n  , create = utils.create\n  ;\n\n/**\n * 为 Bee 构造函数添加指令 (directive). `Bee.directive`\n * @param {String} key directive 名称\n * @param {Object} [opts] directive 参数\n * @param {Number} opts.priority=0 directive 优先级. 同一个元素上的指令按照优先级顺序执行.\n * @param {Boolean} opts.terminal=false 执行该 directive 后, 是否终止后续 directive 执行.\n *   terminal 为真时, 与该 directive 优先级相同的 directive 仍会继续执行, 较低优先级的才会被忽略.\n * @param {Boolean} opts.anchor anchor 为 true 时, 会在指令节点前后各产生一个空白的标记节点. 分别对应 `anchors.start` 和 `anchors.end`\n */\nfunction directive(key, opts) {\n  var dirs = this.directives = this.directives || {};\n\n  return dirs[key] = new Directive(key, opts);\n}\n\nfunction Directive(key, opts) {\n  this.type = key;\n  utils.extend(this, opts);\n}\n\nDirective.prototype = {\n  priority: 0//权重\n, link: utils.noop//初始化方法\n, unLink: utils.noop//销毁回调\n, update: utils.noop//更新方法\n, tearDown: utils.noop\n, terminal: false//是否终止\n, replace: false//是否替换当前元素. 如果是, 将用一个空的文本节点替换当前元素\n, watch: true//是否监控 key 的变化\n\n, anchor: false\n, anchors: null\n\n  //当 anchor 为 true 时, 获取两个锚点之间的所有节点.\n, getNodes: function() {\n    var nodes = [], node = this.anchors.start.nextSibling;\n    if(this.anchor && node) {\n      while(node !== this.anchors.end){\n        nodes.push(node);\n        node = node.nextSibling;\n      }\n\n      return nodes;\n    }else{\n      return null;\n    }\n  }\n  //解析表达式\n, parse: function() {\n    try{\n      this.ast = parse(this.path, this.type);\n    }catch(e) {\n      this.ast = {};\n      e.message = 'SyntaxError in \"' + this.path + '\" | ' + e.message;\n      console.error(e);\n    }\n  }\n  //表达式求值\n  //forgive[true]: 是否将 undefined 及 null 转为空字符\n, getValue: function(scope, forgive) {\n    forgive = forgive !== false;\n    var val;\n\n    try{\n      val = evaluate.eval(this.ast, scope, this);\n    }catch(e){\n      val = '';\n      console.error(e);\n    }\n    if(forgive && (utils.isUndefined(val) || val === null)) {\n      val = '';\n    }\n    return val;\n  }\n};\n\nvar attrPostReg = /\\?$/;\n\n//获取一个元素上所有用 HTML 属性定义的指令\nfunction getDir(el, directives, components, prefix) {\n  prefix = prefix || '';\n  directives = directives || {};\n\n  var attr, attrName, dirName, proto\n    , dirs = [], dir, anchors = {}\n    , parent = el.parentNode\n    , nodeName = el.nodeName.toLowerCase()\n    ;\n\n  //对于自定义标签, 将其转为 directive\n  if(nodeName in components) {\n    el.setAttribute(prefix + 'component', nodeName);\n  }\n\n  for(var i = el.attributes.length - 1; i >= 0; i--){\n    attr = el.attributes[i];\n    attrName = attr.nodeName;\n    dirName = attrName.slice(prefix.length);\n    proto = {el: el, node: attr, nodeName: attrName, path: attr.value};\n    dir = null;\n\n    if(attrName.indexOf(prefix) === 0 && (dirName in directives)) {\n      //指令\n      dir = create(directives[dirName]);\n      dir.dirName = dirName//dir 名\n    }else if(token.hasToken(attr.value)) {\n      //属性表达式可能有多个表达式区\n      token.parseToken(attr.value).forEach(function(origin) {\n        origin.dirName = attrName.indexOf(prefix) === 0 ? dirName : attrName ;\n        dirs.push(utils.extend(create(directives.attr), proto, origin))\n      });\n      //由于已知属性表达式不存在 anchor, 所以直接跳过下面的检测\n    }else if(attrPostReg.test(attrName)) {\n      //条件属性指令\n      dir = utils.extend(create(directives.attr), { dirName: attrName.replace(attrPostReg, ''), conditional: true });\n    }\n\n    if(dir) {\n      if(dir.anchor && !anchors.start) {\n        //同一个元素上的 directive 共享同一对锚点\n        anchors.start = doc.createComment(dir.dirName + ' start');\n        parent.insertBefore(anchors.start, el);\n\n        anchors.end = doc.createComment(dir.dirName + ' end');\n        if(el.nextSibling) {\n          parent.insertBefore(anchors.end, el.nextSibling);\n        }else{\n          parent.appendChild(anchors.end);\n        }\n      }\n      dir.anchors = dir.anchor ? anchors : null;\n      dirs.push(utils.extend(dir, proto));\n    }\n  }\n  dirs.sort(function(d0, d1) {\n    return d1.priority - d0.priority;\n  });\n  return dirs;\n}\n\nDirective.directive = directive;\ndirective.getDir = getDir;\n\nmodule.exports = Directive;\n","\"use strict\";\n\n//属性指令\n\nvar utils = require('../utils.js');\n\nmodule.exports = {\n  link: function() {\n    if(this.dirName === this.type) {//attr binding\n      this.attrs = {};\n    }else {\n      //属性表达式默认将值置空, 防止表达式内变量不存在\n      this.update('')\n    }\n  }\n, update: function(val) {\n    var el = this.el;\n    var newAttrs = {};\n    if(this.dirName === this.type) {\n      for(var attr in val) {\n        setAttr(el, attr, val[attr]);\n        //if(val[attr]) {\n          delete this.attrs[attr];\n        //}\n        newAttrs[attr] = true;\n      }\n\n      //移除不在上次记录中的属性\n      for(var attr in this.attrs) {\n        removeAttr(el, attr);\n      }\n      this.attrs = newAttrs;\n    }else{\n      if(this.conditional) {\n        val ? setAttr(el, this.dirName, val) : removeAttr(el, this.dirName);\n      }else{\n        this.textMap[this.position] = val && (val + '');\n        setAttr(el, this.dirName, this.textMap.join(''));\n      }\n    }\n  }\n};\n\n\n//IE 浏览器很多属性通过 `setAttribute` 设置后无效. \n//这些通过 `el[attr] = value` 设置的属性却能够通过 `removeAttribute` 清除.\nfunction setAttr(el, attr, val){\n  try{\n    if(((attr in el) || attr === 'class')){\n      if(attr === 'style' && el.style.setAttribute){\n        el.style.setAttribute('cssText', val);\n      }else if(attr === 'class'){\n        el.className = val;\n      }else{\n        el[attr] = typeof el[attr] === 'boolean' ? true : val;\n      }\n    }\n  }catch(e){}\n  //chrome setattribute with `{{}}` will throw an error\n  el.setAttribute(attr, val);\n}\n\nfunction removeAttr(el, attr) {\n  el.removeAttribute(attr);\n  delete el[attr];\n}","//component as directive\nvar utils = require('../utils.js');\n\nmodule.exports = {\n  priority: -10\n, watch: false\n, unLink: function() {\n    this.component && this.component.__destroy()\n  }\n, link: function(vm) {\n    var el = this.el;\n    var comName = this.path;\n    var components = vm.constructor.components;\n    var Comp, comp;\n    var dirs = [], $data = {};\n    var attrs;\n\n    if(comName in components) {\n      Comp = components[comName];\n\n      //TODO\n      if(Comp === vm.constructor) {\n        return;\n      }\n\n      dirs = this.dirs;\n\n      dirs = dirs.filter(function (dir) {\n        return dir.type == 'attr' || dir.type == 'with';\n      });\n\n      dirs.forEach(function (dir) {\n        var curPath, comPath;\n\n        curPath = dir.path;\n        if(dir.type === 'with' || dir.dirName === 'attr') {\n          //这里 attr 及 with 指令效果一样\n          comPath = '$data'\n          utils.extend($data, vm.$get(curPath))\n        }else{\n          comPath = dir.dirName;\n          $data[comPath] = vm.$get(curPath);\n        }\n\n        //监听父组件更新, 同步数据\n        vm.$watch(curPath, function (val) {\n          if(comp){\n            val = dir.textMap ? dir.textMap.join('') : val;\n            comp.$set(comPath, val);\n          }\n        })\n      });\n\n      attrs = el.attributes;\n      //普通属性\n      for(var i = attrs.length - 1; i >= 0; i--) {\n        $data[attrs[0].nodeName] = attrs[0].value;\n      }\n\n      this.component = comp = new Comp({\n        $target: el,\n        //$root: vm.$root,\n        $data: utils.extend({}, Comp.prototype.$data, $data)\n      });\n\n      //直接将component 作为根元素时, 同步跟新容器 .$el 引用\n      if(vm.$el === el) {\n        vm.__ref = comp;\n        vm.$el = comp.$el;\n      }\n      return true;\n    }else{\n      console.warn('Component: ' + comName + ' not defined! Ignore');\n    }\n  }\n};\n","\"use strict\";\r\n\r\nvar domUtils = require('../dom-utils')\r\n  , checkBinding = require('../check-binding')\r\n  ;\r\n\r\nmodule.exports = {\r\n  replace: true\r\n, anchor: true\r\n, link: function(vm) {\r\n    this.vm = vm;\r\n  }\r\n, update: function(tpl) {\r\n    var nodes = this.getNodes()\r\n    var parent = this.anchors.end.parentNode\r\n    var content = domUtils.createContent(tpl)\r\n\r\n    checkBinding.walk.call(this.vm, content)\r\n    //TODO 移除对应的 watcher\r\n    nodes.forEach(function(node) {\r\n      parent.removeChild(node);\r\n    })\r\n    parent.insertBefore(content, this.anchors.end)\r\n  }\r\n}","\"use strict\";\n\nvar doc = require('../env.js').document\n  , utils = require('../utils.js')\n  , token = require('../token.js')\n  ;\n\nvar dirs = {};\n\n\ndirs.text = {\n  terminal: true\n, replace: true\n, update: function(val) {\n    this.node.nodeValue = utils.isUndefined(val) ? '' : val;\n  }\n};\n\n\ndirs.html = {\n  terminal: true\n, replace: true\n, link: function() {\n    this.nodes = [];\n  }\n, update: function(val) {\n    var el = doc.createElement('div');\n    el.innerHTML = utils.isUndefined(val) ? '' : val;\n\n    var node;\n    while(node = this.nodes.pop()) {\n      node.parentNode && node.parentNode.removeChild(node);\n    }\n\n    var nodes = el.childNodes;\n    while(node = nodes[0]) {\n      this.nodes.push(node);\n      this.el.insertBefore(node, this.node);\n    }\n  }\n};\n\n\ndirs['if'] = {\n  anchor: true\n, link: function() {\n    if(this.el.content) {\n      this.frag = this.el.content;\n      this.el.parentNode.removeChild(this.el);\n    }else{\n      this.frag = doc.createDocumentFragment()\n      this.hide();\n    }\n  }\n, update: function(val) {\n    if(val) {\n      if(!this.state) { this.show() }\n    }else{\n      if(this.state) { this.hide(); }\n    }\n    this.state = val;\n  }\n\n, show: function() {\n    var anchor = this.anchors.end;\n\n    anchor.parentNode && anchor.parentNode.insertBefore(this.frag, anchor);\n  }\n, hide: function() {\n    var nodes = this.getNodes();\n\n    if(nodes) {\n      for(var i = 0, l = nodes.length; i < l; i++) {\n        this.frag.appendChild(nodes[i]);\n      }\n    }\n  }\n};\n\ndirs.template = {\n  priority: 10000\n, link: function() {\n    var nodes = this.el.childNodes\n      , frag = doc.createDocumentFragment()\n      ;\n\n    while(nodes[0]) {\n      frag.appendChild(nodes[0]);\n    }\n\n    this.el.content = frag;\n\n    //this.el.setAttribute(this.nodeName, '');\n  }\n};\n\n//图片用, 避免加载大括号的原始模板内容\ndirs.src = {\n  update: function(val) {\n    this.el.src = val;\n  }\n};\n\ndirs['with'] = {};\n\ndirs.repeat = require('./repeat.js');\ndirs.attr = require('./attr.js');\ndirs.model = require('./model.js');\ndirs.style = require('./style.js');\ndirs.on = require('./on.js');\ndirs.component = require('./component.js');\ndirs.content = require('./content.js')\n\nmodule.exports = dirs;\n","\"use strict\";\n\nvar utils = require('../utils.js')\n  , hasToken = require('../token.js').hasToken\n  , events = require('../event-bind.js')\n  ;\n\nmodule.exports = {\n  teminal: true\n, priority: 1\n, link: function(vm) {\n    var keyPath = this.path;\n\n    if(!keyPath) { return false; }\n\n    var el = this.el\n      , ev = 'change'\n      , attr, value = attr = 'value'\n      , ant = vm\n      , isSetDefaut = utils.isUndefined(ant.$get(keyPath))//界面的初始值不会覆盖 model 的初始值\n      , crlf = /\\r\\n/g//IE 8 下 textarea 会自动将 \\n 换行符换成 \\r\\n. 需要将其替换回来\n      , callback = function(val) {\n          var newVal = (val || '') + ''\n            , val = el[attr]\n            ;\n          val && val.replace && (val = val.replace(crlf, '\\n'));\n          if(newVal !== val){ el[attr] = newVal; }\n        }\n      , handler = function(isInit) {\n          var val = el[value];\n\n          val.replace && (val = val.replace(crlf, '\\n'));\n          ant.$set(keyPath, val);\n        }\n      , callHandler = function(e) {\n          if(e && e.propertyName && e.propertyName !== attr) {\n            return;\n          }\n          handler.apply(this, arguments)\n        }\n      , ie = utils.ie\n      ;\n\n    switch(el.tagName) {\n      default:\n        value = attr = 'innerHTML';\n        //ev += ' blur';\n      case 'INPUT':\n      case 'TEXTAREA':\n        switch(el.type) {\n          case 'checkbox':\n            value = attr = 'checked';\n            //IE6, IE7 下监听 propertychange 会挂?\n            if(ie) { ev += ' click'; }\n          break;\n          case 'radio':\n            attr = 'checked';\n            if(ie) { ev += ' click'; }\n            callback = function(val) {\n              el.checked = el.value === val + '';\n            };\n            isSetDefaut = el.checked;\n          break;\n          default:\n            if(!ant.$lazy){\n              if('oninput' in el){\n                ev += ' input';\n              }\n              //IE 下的 input 事件替代\n              if(ie) {\n                ev += ' keyup propertychange cut';\n              }\n            }\n          break;\n        }\n      break;\n      case 'SELECT':\n        if(el.multiple){\n          handler = function(isInit) {\n            var vals = [];\n            for(var i = 0, l = el.options.length; i < l; i++){\n              if(el.options[i].selected){ vals.push(el.options[i].value) }\n            }\n            ant.$set(keyPath, vals);\n          };\n          callback = function(vals){\n            if(vals && vals.length){\n              for(var i = 0, l = el.options.length; i < l; i++){\n                el.options[i].selected = vals.indexOf(el.options[i].value) !== -1;\n              }\n            }\n          };\n        }\n        isSetDefaut = isSetDefaut && !hasToken(el[value]);\n      break;\n    }\n\n    this.update = callback;\n\n    ev.split(/\\s+/g).forEach(function(e){\n      events.removeEvent(el, e, callHandler);\n      events.addEvent(el, e, callHandler);\n    });\n\n    //根据表单元素的初始化默认值设置对应 model 的值\n    if(el[value] && isSetDefaut){\n       handler(true);\n    }\n\n  }\n};\n","\"use strict\";\n\n//事件监听\n\nvar eventBind = require('../event-bind.js');\nvar utils = require('../utils')\n\n//TODO 移除时的情况\nmodule.exports = {\n  watch: false\n, link: function(vm) {\n    //this.events = {};\n    this.vm = vm;\n  }\n, update: function(events) {\n    var selector, eventType;\n    for(var name in events) {\n      selector = name.split(/\\s+/);\n      eventType = selector.shift();\n      selector = selector.join(' ');\n      eventBind.addEvent(this.el, eventType, callHandler(this, selector, events[name]));\n    }\n  }\n}\n\n//委托事件\nfunction callHandler (dir, selector, callback) {\n  return function(e) {\n    var cur = e.target || e.srcElement;\n    var els = selector ? utils.toArray(dir.el.querySelectorAll(selector)) : [cur];\n    do{\n      if(els.indexOf(cur) >= 0) {\n        e.delegateTarget = cur;//委托元素\n        return callback.call(dir.vm, e)\n      }\n    }while(cur = cur.parentNode)\n  }\n}\n","\"use strict\";\n\nvar doc = require('../env.js').document\n  , utils = require('../utils.js')\n  ;\n\n//这些数组操作方法被重写成自动触发更新\nvar arrayMethods = ['splice', 'push', 'pop', 'shift', 'unshift', 'sort', 'reverse'];\n\nmodule.exports = {\n  priority: 1000\n, anchor: true\n, terminal: true\n, link: function(vm) {\n    var cstr = this.cstr = vm.constructor;\n    this.vm = vm;\n\n    while(cstr.__super__){\n      cstr = cstr.__super__.constructor;\n    }\n\n    //只继承静态的默认参数\n    this.cstr = cstr.extend({}, this.cstr)\n\n    this.curArr = [];\n    this.list = [];//子 VM list\n\n    this.el.parentNode.removeChild(this.el);\n  }\n, update: function(items) {\n    var curArr = this.curArr;\n    var parentNode = this.anchors.end.parentNode;\n    var that = this, list = this.list;\n\n    if(utils.isArray(items)) {\n      // 在 repeat 指令表达式中\n      this.listPath = this.summary.locals.filter(function(path) {\n        return !utils.isFunction(that.vm.$get(path))\n      });\n\n      //删除元素\n      //TODO 删除引用父级的 watchers\n      arrDiff(curArr, items).forEach(function(item) {\n        var pos = curArr.indexOf(item)\n        curArr.splice(pos, 1)\n        parentNode.removeChild(list[pos].$el)\n        list[pos].__destroy()\n        list.splice(pos, 1)\n      })\n\n      items.forEach(function(item, i) {\n        var pos = items.indexOf(item, i)\n          , oldPos = curArr.indexOf(item, i)\n          , vm, el\n          ;\n\n        //pos < 0 && (pos = items.lastIndexOf(item, i));\n        //oldPos < 0 && (oldPos = curArr.lastIndexOf(item, i));\n\n        //新增元素\n        if(oldPos < 0) {\n\n          el = this.el.cloneNode(true)\n\n          vm = new this.cstr(el, {\n            $data: item, _assignments: this.summary.assignments, $index: pos,\n            $root: this.vm.$root, $parent: this.vm,\n            __repeat: true\n          });\n          parentNode.insertBefore(vm.$el, list[pos] && list[pos].$el || this.anchors.end)\n          list.splice(pos, 0, vm);\n          curArr.splice(pos, 0, item)\n\n          //延时赋值给 `_relativePath`, 避免出现死循环\n          //如果在上面实例化时当参数传入, 会冒泡到父级 vm 递归调用这里的 update 方法, 造成死循环.\n          vm._relativePath = this.listPath;\n        }else {\n\n          //调序\n          if (pos !== oldPos) {\n            parentNode.insertBefore(list[oldPos].$el, list[pos] && list[pos].$el || that.anchor.end)\n            parentNode.insertBefore(list[pos].$el, list[oldPos + 1] && list[oldPos + 1].$el || that.anchor.end)\n            list[oldPos] = [list[pos], list[pos] = list[oldPos]][0]\n            curArr[oldPos] = [curArr[pos], curArr[pos] = curArr[oldPos]][0]\n            list[pos].$index = pos\n            list[pos].$update('$index')\n          }\n        }\n      }.bind(this))\n\n      //更新索引\n      this.list.forEach(function(vm, i) {\n        vm.$index = i\n        vm.$el.$index = i\n        vm.$update('$index', false)\n      });\n\n      if(!items.__dirs__){\n        //数组操作方法\n        utils.extend(items, {\n          $set: function(i, item) {\n            items.__dirs__.forEach(function(dir) {\n              dir.list[i].$set(item);\n            })\n          },\n          $replace: function(i, item) {\n            items.__dirs__.forEach(function(dir) {\n              dir.list[i].$replace(item)\n            })\n          },\n          $remove: function(i) {\n            items.splice(i, 1);\n            items.__dirs__.forEach(function(dir) {\n              dir.listPath.forEach(function (path) {\n                dir.vm.$update(path)\n              });\n            })\n          }\n        });\n        arrayMethods.forEach(function(method) {\n          items[method] = utils.afterFn(items[method], function() {\n            items.__dirs__.forEach(function(dir) {\n              dir.listPath.forEach(function(path) {\n                dir.vm.$update(path)\n              })\n            })\n          })\n        });\n        items.__dirs__  = [];\n      }\n      //一个数组多处使用\n      //TODO 移除时的情况\n      if(items.__dirs__.indexOf(that) === -1) {\n        items.__dirs__.push(that)\n      }\n    }else{\n      //TODO 普通对象的遍历\n    }\n  }\n};\n\n\nfunction arrDiff(arr1, arr2) {\n  var arr2Copy = arr2.slice();\n  return arr1.filter(function(el) {\n    var result, index = arr2Copy.indexOf(el)\n    if(index < 0) {\n      result = true\n    }else{\n      arr2Copy.splice(index, 1)\n    }\n    return result\n  })\n}\n","\"use strict\";\n\n//样式指令\n\nvar camelReg = /([A-Z])/g;\n\n//默认单位为 px 的属性\n//TODO 待完善\nvar pixelAttrs = [\n  'width','height',\n  'margin', 'margin-top', 'margin-right', 'margin-left', 'margin-bottom',\n  'padding', 'padding-top', 'padding-right', 'padding-bottom', 'padding-left'\n]\n\nmodule.exports = {\n  update: function(styles) {\n    var el = this.el;\n    var styleStr = '';\n    var dashKey, val;\n\n    for(var key in styles) {\n      val = styles[key];\n\n      dashKey = key.replace(camelReg, function (upperChar) {\n        return '-' + upperChar.toLowerCase();\n      });\n\n      if(!isNaN(val) && pixelAttrs.indexOf(dashKey) >= 0) {\n        val += 'px';\n      }\n      styleStr += dashKey + ': ' + val + '; ';\n    }\n    if(el.style.setAttribute){\n      //老 IE\n      el.style.setAttribute('cssText', styleStr);\n    }else{\n      el.setAttribute('style', styleStr);\n    }\n  }\n};","\"use strict\";\r\n\r\nvar doc = require('./env.js').document\r\nvar utils = require('./utils')\r\n\r\n//处理 $target,  $content, $tpl\r\n//target: el 替换的目标\r\nfunction tplParse(tpl, target, content) {\r\n  var el;\r\n  if(utils.isObject(target) && target.childNodes) {\r\n    content = createContent(target.childNodes);\r\n  }else{\r\n    if(content) {\r\n      content = createContent(content)\r\n    }\r\n  }\r\n\r\n  if(utils.isObject(tpl)){\r\n    //DOM 元素\r\n    el = tpl;\r\n    tpl = el.outerHTML;\r\n  }else{\r\n    //字符串\r\n    el = createContent(tpl).childNodes[0];\r\n  }\r\n\r\n  if(target){\r\n    target.parentNode && target.parentNode.replaceChild(el, target);\r\n  }\r\n\r\n  return {el: el, tpl: tpl, content: content};\r\n}\r\n\r\n//将模板/元素/nodelist 包裹在 fragment 中\r\nfunction createContent(tpl) {\r\n  var content = doc.createDocumentFragment();\r\n  var wraper;\r\n  var nodes = [];\r\n  if(utils.isObject(tpl)) {\r\n    if(tpl.nodeName && tpl.nodeType) {\r\n      //dom 元素\r\n      content.appendChild(tpl);\r\n    }else if('length' in tpl){\r\n      //nodelist\r\n      nodes = tpl;\r\n    }\r\n  }else {\r\n    wraper = doc.createElement('div')\r\n    //自定义标签在 IE8 下无效. 使用 component 指令替代\r\n    wraper.innerHTML = (tpl + '').trim();\r\n    nodes = wraper.childNodes;\r\n  }\r\n  while(nodes[0]) {\r\n    content.appendChild(nodes[0])\r\n  }\r\n  return content;\r\n}\r\n\r\nmodule.exports = {\r\n  tplParse: tplParse,\r\n  createContent: createContent\r\n};","(function(root){\n  \"use strict\";\n\n  exports.root = root;\n  exports.document = root.document || require('jsdom').jsdom();\n\n})((function() {return this})());\n","\"use strict\";\n\nvar operators = {\n  'unary': {\n    '+': function(v) { return +v; }\n  , '-': function(v) { return -v; }\n  , '!': function(v) { return !v; }\n\n  , '[': function(v){ return v; }\n  , '{': function(v){\n      var r = {};\n      for(var i = 0, l = v.length; i < l; i++) {\n        r[v[i][0]] = v[i][1];\n      }\n      return r;\n    }\n  , 'typeof': function(v){ return typeof v; }\n  , 'new': function(v){ return new v }\n  }\n\n, 'binary': {\n    '+': function(l, r) { return l + r; }\n  , '-': function(l, r) { return l - r; }\n  , '*': function(l, r) { return l * r; }\n  , '/': function(l, r) { return l / r; }\n  , '%': function(l, r) { return l % r; }\n  , '<': function(l, r) { return l < r; }\n  , '>': function(l, r) { return l > r; }\n  , '<=': function(l, r) { return l <= r; }\n  , '>=': function(l, r) { return l >= r; }\n  , '==': function(l, r) { return l == r; }\n  , '!=': function(l, r) { return l != r; }\n  , '===': function(l, r) { return l === r; }\n  , '!==': function(l, r) { return l !== r; }\n  , '&&': function(l, r) { return l && r; }\n  , '||': function(l, r) { return l || r; }\n  , ',': function(l, r) { return l, r; }\n\n  , '.': function(l, r) {\n      if(r){\n        path = path + '.' + r;\n      }\n      return l[r];\n    }\n  , '[': function(l, r) {\n      if(typeof r !== 'undefined'){\n        path = path + '.' + r;\n      }\n      return l[r];\n    }\n\n  , '(': function(l, r){ return l.apply(context.locals, r) }\n  , '|': function(l, r){ return r.call(context.locals, l) }//filter. name|filter\n  , 'new': function(l, r){\n      return l === Date ? new Function('return new Date(' + r.join(', ') + ')')() : new (Function.prototype.bind.apply(l, r));\n    }\n\n  , 'in': function(l, r){\n      if(this.assignment) {\n        //repeat\n        return r;\n      }else{\n        return l in r;\n      }\n    }\n  }\n\n, 'ternary': {\n    '?': function(f, s, t) { return f ? s : t; }\n  , '(': function(f, s, t) { return f[s].apply(f, t) }\n\n  //filter. name | filter : arg2 : arg3\n  , '|': function(f, s, t){ return s.apply(context.locals, [f].concat(t)); }\n  }\n};\n\nvar argName = ['first', 'second', 'third']\n  , context, summary, summaryCall\n  , path\n  , self\n  ;\n\n//遍历 ast\nvar evaluate = function(tree) {\n  var arity = tree.arity\n    , value = tree.value\n    , args = []\n    , n = 0\n    , arg\n    , res\n    ;\n\n  //操作符最多只有三元\n  for(; n < 3; n++){\n    arg = tree[argName[n]];\n    if(arg){\n      if(Array.isArray(arg)){\n        args[n] = [];\n        for(var i = 0, l = arg.length; i < l; i++){\n          args[n].push(typeof arg[i].key === 'undefined' ?\n            evaluate(arg[i]) : [arg[i].key, evaluate(arg[i])]);\n        }\n      }else{\n        args[n] = evaluate(arg);\n      }\n    }\n  }\n\n  if(arity !== 'literal') {\n    if(path && value !== '.' && value !== '[') {\n      summary.paths[path] = true;\n    }\n    if(arity === 'name') {\n      path = value;\n    }\n  }\n\n  switch(arity){\n    case 'unary':\n    case 'binary':\n    case 'ternary':\n      try{\n        res = getOperator(arity, value).apply(tree, args);\n      }catch(e){\n        summaryCall || console.warn(e);\n      }\n    break;\n    case 'literal':\n      res = value;\n    break;\n    case 'assignment':\n      summary.assignments[value] = true;\n    break;\n    case 'name':\n      summary.locals[value] = true;\n      res = getValue(value, context.locals);\n    break;\n    case 'filter':\n      summary.filters[value] = true;\n      res = context.filters[value];\n    break;\n    case 'this':\n      res = context.locals;//TODO this 指向 vm 还是 dir?\n    break;\n  }\n  return res;\n};\n\nfunction getOperator(arity, value){\n  return operators[arity][value] || function() { return; }\n}\n\nfunction reset(scope, that) {\n  summaryCall = true;\n  if(scope) {\n    summaryCall = false;\n    context = {locals: scope || {}, filters: scope.$filters || {}};\n  }else{\n    context = {filters: {}, locals: {}};\n  }\n  if(that){\n    self = that;\n  }\n\n  summary = {filters: {}, locals: {}, paths: {}, assignments: {}};\n  path = '';\n}\n\n//在作用域中查找值\nvar getValue = require('./scope').getValue\n\n//表达式求值\n//tree: parser 生成的 ast\n//scope 执行环境\nexports.eval = function(tree, scope, that) {\n  reset(scope || {}, that);\n\n  return evaluate(tree);\n};\n\n//表达式摘要\n//return: {filters:[], locals:[], paths: [], assignments: []}\nexports.summary = function(tree) {\n  reset();\n\n  evaluate(tree);\n\n  if(path) {\n    summary.paths[path] = true;\n  }\n  for(var key in summary) {\n    summary[key] = Object.keys(summary[key]);\n  }\n  return summary;\n};\n","\"use strict\";\n\nexports.addEvent = function addEvent(el, event, handler) {\n  if(el.addEventListener) {\n    el.addEventListener(event, handler, false);\n  }else{\n    el.attachEvent('on' + event, handler);\n  }\n}\n\nexports.removeEvent = function removeEvent(el, event, handler) {\n  if(el.removeEventListener) {\n    el.removeEventListener(event, handler);\n  }else{\n    el.detachEvent('on' + event, handler);\n  }\n}","var utils = require('./utils.js');\n\nvar Event = {\n  //监听自定义事件.\n  $on: function(name, handler, context) {\n    var ctx = context || this\n      ;\n\n    ctx._handlers = ctx._handlers || {};\n    ctx._handlers[name] = ctx._handlers[name] || [];\n\n    ctx._handlers[name].push({handler: handler, context: context, ctx: ctx});\n    return this;\n  },\n  $one: function (name, handler, context) {\n    if(handler){\n      handler.one = true;\n    }\n    return this.on(name, handler, context);\n  },\n  //移除监听事件.\n  $off: function(name, handler, context) {\n    var ctx = context || this\n      , handlers = ctx._handlers\n      ;\n\n    if(name && handlers[name]){\n      if(utils.isFunction(handler)){\n        for(var i = handlers[name].length - 1; i >=0; i--) {\n          if(handlers[name][i].handler === handler){\n            handlers[name].splice(i, 1);\n          }\n        }\n      }else{\n        handlers[name] = [];\n      }\n    }\n    return this;\n  },\n  //触发自定义事件.\n  //该方法没有提供静态化的 context 参数. 如要静态化使用, 应该: `Event.trigger.call(context, name, data)`\n  $trigger: function(name, data) {\n    var args = [].slice.call(arguments, 1)\n      , handlers = this._handlers && this._handlers[name]\n      ;\n\n    if(handlers){\n      for(var i = 0, item; item = handlers[i]; i++) {\n        item.handler.apply(this, args);\n        if(item.handler.one) {\n          handlers.splice(i, 1);\n          i--;\n        }\n      }\n    }\n    return this;\n  }\n};\n\nmodule.exports = Event;\n","\"use strict\";\n//Javascript expression parser modified form Crockford's TDOP parser\nvar create = Object.create || function (o) {\n\tfunction F() {}\n\tF.prototype = o;\n\treturn new F();\n};\n\nvar source;\n\nvar error = function (message, t) {\n\tt = t || this;\n  var msg = message += \" But found '\" + t.value + \"'\" + (t.from ? \" at \" + t.from : \"\") + \" in '\" + source + \"'\";\n  var e = new Error(msg);\n\te.name = t.name = \"SyntaxError\";\n\tt.message = message;\n  throw e;\n};\n\nvar tokenize = function (code, prefix, suffix) {\n\tvar c; // The current character.\n\tvar from; // The index of the start of the token.\n\tvar i = 0; // The index of the current character.\n\tvar length = code.length;\n\tvar n; // The number value.\n\tvar q; // The quote character.\n\tvar str; // The string value.\n\n\tvar result = []; // An array to hold the results.\n\n\t// Make a token object.\n\tvar make = function (type, value) {\n\t\treturn {\n\t\t\ttype : type,\n\t\t\tvalue : value,\n\t\t\tfrom : from,\n\t\t\tto : i\n\t\t};\n\t};\n\n\t// Begin tokenization. If the source string is empty, return nothing.\n\tif (!code) {\n\t\treturn;\n\t}\n\n\t// Loop through code text, one character at a time.\n\tc = code.charAt(i);\n\twhile (c) {\n\t\tfrom = i;\n\n\t\tif (c <= ' ') { // Ignore whitespace.\n\t\t\ti += 1;\n\t\t\tc = code.charAt(i);\n\t\t} else if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') || c === '$' || c === '_') { // name.\n\t\t\tstr = c;\n\t\t\ti += 1;\n\t\t\tfor (; ; ) {\n\t\t\t\tc = code.charAt(i);\n\t\t\t\tif ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||\n\t\t\t\t\t(c >= '0' && c <= '9') || c === '_') {\n\t\t\t\t\tstr += c;\n\t\t\t\t\ti += 1;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tresult.push(make('name', str));\n\t\t} else if (c >= '0' && c <= '9') {\n\t\t\t// number.\n\n\t\t\t// A number cannot start with a decimal point. It must start with a digit,\n\t\t\t// possibly '0'.\n\t\t\tstr = c;\n\t\t\ti += 1;\n\n\t\t\t// Look for more digits.\n\t\t\tfor (; ; ) {\n\t\t\t\tc = code.charAt(i);\n\t\t\t\tif (c < '0' || c > '9') {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti += 1;\n\t\t\t\tstr += c;\n\t\t\t}\n\n\t\t\t// Look for a decimal fraction part.\n\t\t\tif (c === '.') {\n\t\t\t\ti += 1;\n\t\t\t\tstr += c;\n\t\t\t\tfor (; ; ) {\n\t\t\t\t\tc = code.charAt(i);\n\t\t\t\t\tif (c < '0' || c > '9') {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ti += 1;\n\t\t\t\t\tstr += c;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Look for an exponent part.\n\t\t\tif (c === 'e' || c === 'E') {\n\t\t\t\ti += 1;\n\t\t\t\tstr += c;\n\t\t\t\tc = code.charAt(i);\n\t\t\t\tif (c === '-' || c === '+') {\n\t\t\t\t\ti += 1;\n\t\t\t\t\tstr += c;\n\t\t\t\t\tc = code.charAt(i);\n\t\t\t\t}\n\t\t\t\tif (c < '0' || c > '9') {\n\t\t\t\t\terror(\"Bad exponent\", make('number', str));\n\t\t\t\t}\n\t\t\t\tdo {\n\t\t\t\t\ti += 1;\n\t\t\t\t\tstr += c;\n\t\t\t\t\tc = code.charAt(i);\n\t\t\t\t} while (c >= '0' && c <= '9');\n\t\t\t}\n\n\t\t\t// Make sure the next character is not a letter.\n\n\t\t\tif (c >= 'a' && c <= 'z') {\n\t\t\t\tstr += c;\n\t\t\t\ti += 1;\n\t\t\t\terror(\"Bad number\", make('number', str));\n\t\t\t}\n\n\t\t\t// Convert the string value to a number. If it is finite, then it is a good\n\t\t\t// token.\n\n\t\t\tn = +str;\n\t\t\tif (isFinite(n)) {\n\t\t\t\tresult.push(make('number', n));\n\t\t\t} else {\n\t\t\t\terror(\"Bad number\", make('number', str));\n\t\t\t}\n\n\t\t\t// string\n\n\t\t} else if (c === '\\'' || c === '\"') {\n\t\t\tstr = '';\n\t\t\tq = c;\n\t\t\ti += 1;\n\t\t\tfor (; ; ) {\n\t\t\t\tc = code.charAt(i);\n\t\t\t\tif (c < ' ') {\n\t\t\t\t\tmake('string', str);\n\t\t\t\t\terror(c === '\\n' || c === '\\r' || c === '' ?\n\t\t\t\t\t\t\"Unterminated string.\" :\n\t\t\t\t\t\t\"Control character in string.\", make('', str));\n\t\t\t\t}\n\n\t\t\t\t// Look for the closing quote.\n\n\t\t\t\tif (c === q) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Look for escapement.\n\n\t\t\t\tif (c === '\\\\') {\n\t\t\t\t\ti += 1;\n\t\t\t\t\tif (i >= length) {\n\t\t\t\t\t\terror(\"Unterminated string\", make('string', str));\n\t\t\t\t\t}\n\t\t\t\t\tc = code.charAt(i);\n\t\t\t\t\tswitch (c) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tc = '\\b';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\tc = '\\f';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tc = '\\n';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r':\n\t\t\t\t\t\tc = '\\r';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tc = '\\t';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'u':\n\t\t\t\t\t\tif (i >= length) {\n\t\t\t\t\t\t\terror(\"Unterminated string\", make('string', str));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tc = parseInt(code.substr(i + 1, 4), 16);\n\t\t\t\t\t\tif (!isFinite(c) || c < 0) {\n\t\t\t\t\t\t\terror(\"Unterminated string\", make('string', str));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tc = String.fromCharCode(c);\n\t\t\t\t\t\ti += 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstr += c;\n\t\t\t\ti += 1;\n\t\t\t}\n\t\t\ti += 1;\n\t\t\tresult.push(make('string', str));\n\t\t\tc = code.charAt(i);\n\n\t\t\t// combining\n\n\t\t} else if (prefix.indexOf(c) >= 0) {\n\t\t\tstr = c;\n\t\t\ti += 1;\n\t\t\twhile (true) {\n\t\t\t\tc = code.charAt(i);\n\t\t\t\tif (i >= length || suffix.indexOf(c) < 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tstr += c;\n\t\t\t\ti += 1;\n\t\t\t}\n\t\t\tresult.push(make('operator', str));\n\n\t\t\t// single-character operator\n\n\t\t} else {\n\t\t\ti += 1;\n\t\t\tresult.push(make('operator', c));\n\t\t\tc = code.charAt(i);\n\t\t}\n\t}\n\treturn result;\n};\n\nvar make_parse = function (vars) {\n\tvars = vars || {};//预定义的变量\n\tvar symbol_table = {};\n\tvar token;\n\tvar tokens;\n\tvar token_nr;\n\tvar context;\n\n\tvar itself = function () {\n\t\treturn this;\n\t};\n\n\tvar find = function (n) {\n\t\tn.nud = itself;\n\t\tn.led = null;\n\t\tn.std = null;\n\t\tn.lbp = 0;\n\t\treturn n;\n\t};\n\n\tvar advance = function (id) {\n\t\tvar a, o, t, v;\n\t\tif (id && token.id !== id) {\n\t\t\terror(\"Expected '\" + id + \"'.\", token);\n\t\t}\n\t\tif (token_nr >= tokens.length) {\n\t\t\ttoken = symbol_table[\"(end)\"];\n\t\t\treturn;\n\t\t}\n\t\tt = tokens[token_nr];\n\t\ttoken_nr += 1;\n\t\tv = t.value;\n\t\ta = t.type;\n\t\tif ((a === \"operator\" || a !== 'string') && v in symbol_table) {\n\t\t\t//true, false 等直接量也会进入此分支\n\t\t\to = symbol_table[v];\n\t\t\tif (!o) {\n\t\t\t\terror(\"Unknown operator.\", t);\n\t\t\t}\n\t\t} else if (a === \"name\") {\n\t\t\to = find(t);\n\t\t} else if (a === \"string\" || a === \"number\" || a === \"regexp\") {\n\t\t\to = symbol_table[\"(literal)\"];\n\t\t\ta = \"literal\";\n\t\t} else {\n\t\t\terror(\"Unexpected token.\", t);\n\t\t}\n\t\ttoken = create(o);\n\t\ttoken.from = t.from;\n\t\ttoken.to = t.to;\n\t\ttoken.value = v;\n\t\ttoken.arity = a;\n\t\treturn token;\n\t};\n\n  //表达式\n  //rbp: right binding power 右侧约束力\n\tvar expression = function (rbp) {\n\t\tvar left;\n\t\tvar t = token;\n\t\tadvance();\n\t\tleft = t.nud();\n\t\twhile (rbp < token.lbp) {\n\t\t\tt = token;\n\t\t\tadvance();\n\t\t\tleft = t.led(left);\n\t\t}\n\t\treturn left;\n\t};\n\n\tvar original_symbol = {\n\t\tnud : function () {\n\t\t\terror(\"Undefined.\", this);\n\t\t},\n\t\tled : function (left) {\n\t\t\terror(\"Missing operator.\", this);\n\t\t}\n\t};\n\n\tvar symbol = function (id, bp) {\n\t\tvar s = symbol_table[id];\n\t\tbp = bp || 0;\n\t\tif (s) {\n\t\t\tif (bp >= s.lbp) {\n\t\t\t\ts.lbp = bp;\n\t\t\t}\n\t\t} else {\n\t\t\ts = create(original_symbol);\n\t\t\ts.id = s.value = id;\n\t\t\ts.lbp = bp;\n\t\t\tsymbol_table[id] = s;\n\t\t}\n\t\treturn s;\n\t};\n\n\tvar constant = function (s, v, a) {\n\t\tvar x = symbol(s);\n\t\tx.nud = function () {\n\t\t\tthis.value = symbol_table[this.id].value;\n\t\t\tthis.arity = \"literal\";\n\t\t\treturn this;\n\t\t};\n\t\tx.value = v;\n\t\treturn x;\n\t};\n\n\tvar infix = function (id, bp, led) {\n\t\tvar s = symbol(id, bp);\n\t\ts.led = led || function (left) {\n\t\t\tthis.first = left;\n\t\t\tthis.second = expression(bp);\n\t\t\tthis.arity = \"binary\";\n\t\t\treturn this;\n\t\t};\n\t\treturn s;\n\t};\n\n\tvar infixr = function (id, bp, led) {\n\t\tvar s = symbol(id, bp);\n\t\ts.led = led || function (left) {\n\t\t\tthis.first = left;\n\t\t\tthis.second = expression(bp - 1);\n\t\t\tthis.arity = \"binary\";\n\t\t\treturn this;\n\t\t};\n\t\treturn s;\n\t};\n\n\tvar prefix = function (id, nud) {\n\t\tvar s = symbol(id);\n\t\ts.nud = nud || function () {\n\t\t\tthis.first = expression(70);\n\t\t\tthis.arity = \"unary\";\n\t\t\treturn this;\n\t\t};\n\t\treturn s;\n\t};\n\n\tsymbol(\"(end)\");\n\tsymbol(\"(name)\");\n\tsymbol(\":\");\n\tsymbol(\")\");\n\tsymbol(\"]\");\n\tsymbol(\"}\");\n\tsymbol(\",\");\n\n\tconstant(\"true\", true);\n\tconstant(\"false\", false);\n\tconstant(\"null\", null);\n\tconstant(\"undefined\");\n\n\tconstant(\"Math\", Math);\n\tconstant(\"Date\", Date);\n\tfor(var v in vars) {\n\t\tconstant(v, vars[v]);\n\t}\n\n\tsymbol(\"(literal)\").nud = itself;\n\n\tsymbol(\"this\").nud = function () {\n\t  this.arity = \"this\";\n\t  return this;\n\t};\n\n\t//Operator Precedence:\n\t//https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence\n\n  infix(',', 1);\n\tinfix(\"?\", 20, function (left) {\n\t\tthis.first = left;\n\t\tthis.second = expression(0);\n\t\tadvance(\":\");\n\t\tthis.third = expression(0);\n\t\tthis.arity = \"ternary\";\n\t\treturn this;\n\t});\n\n\tinfixr(\"&&\", 31);\n\tinfixr(\"||\", 30);\n\n\tinfixr(\"===\", 40);\n\tinfixr(\"!==\", 40);\n\n\tinfixr(\"==\", 40);\n\tinfixr(\"!=\", 40);\n\n\tinfixr(\"<\", 40);\n\tinfixr(\"<=\", 40);\n\tinfixr(\">\", 40);\n\tinfixr(\">=\", 40);\n\n\tinfix(\"in\", 45, function (left) {\n\t\tthis.first = left;\n\t\tthis.second = expression(0);\n\t\tthis.arity = \"binary\";\n\t\tif (context === 'repeat') {\n\t\t\t// `in` at repeat block\n\t\t\tleft.arity = 'assignment';\n\t\t\tthis.assignment = true;\n\t\t}\n\t\treturn this;\n\t});\n\n\tinfix(\"+\", 50);\n\tinfix(\"-\", 50);\n\n\tinfix(\"*\", 60);\n\tinfix(\"/\", 60);\n\tinfix(\"%\", 60);\n\n\tinfix(\"(\", 70, function (left) {\n\t\tvar a = [];\n\t\tif (left.id === \".\" || left.id === \"[\") {\n\t\t\tthis.arity = \"ternary\";\n\t\t\tthis.first = left.first;\n\t\t\tthis.second = left.second;\n\t\t\tthis.third = a;\n\t\t} else {\n\t\t\tthis.arity = \"binary\";\n\t\t\tthis.first = left;\n\t\t\tthis.second = a;\n\t\t\tif ((left.arity !== \"unary\" || left.id !== \"function\") &&\n\t\t\t\tleft.arity !== \"name\" && left.arity !== \"literal\" && left.id !== \"(\" &&\n\t\t\t\tleft.id !== \"&&\" && left.id !== \"||\" && left.id !== \"?\") {\n\t\t\t\terror(\"Expected a variable name.\", left);\n\t\t\t}\n\t\t}\n\t\tif (token.id !== \")\") {\n\t\t\twhile (true) {\n\t\t\t\ta.push(expression(1));\n\t\t\t\tif (token.id !== \",\") {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tadvance(\",\");\n\t\t\t}\n\t\t}\n\t\tadvance(\")\");\n\t\treturn this;\n\t});\n\n\tinfix(\".\", 80, function (left) {\n\t\tthis.first = left;\n\t\tif (token.arity !== \"name\") {\n\t\t\terror(\"Expected a property name.\", token);\n\t\t}\n\t\ttoken.arity = \"literal\";\n\t\tthis.second = token;\n\t\tthis.arity = \"binary\";\n\t\tadvance();\n\t\treturn this;\n\t});\n\n\tinfix(\"[\", 80, function (left) {\n\t\tthis.first = left;\n\t\tthis.second = expression(0);\n\t\tthis.arity = \"binary\";\n\t\tadvance(\"]\");\n\t\treturn this;\n\t});\n\n\t//filter\n\tinfix(\"|\", 10, function (left) {\n\t\tvar a;\n\t\tthis.first = left;\n\t\ttoken.arity = 'filter';\n\t\tthis.second = expression(10);\n\t\tthis.arity = 'binary';\n\t\tif (token.id === ':') {\n\t\t\tthis.arity = 'ternary';\n\t\t\tthis.third = a = [];\n\t\t\twhile (true) {\n\t\t\t\tadvance(':');\n\t\t\t\ta.push(expression(0));\n\t\t\t\tif (token.id !== \":\") {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t});\n\n\tprefix(\"!\");\n\tprefix(\"-\");\n\tprefix(\"typeof\");\n\n\tprefix(\"(\", function () {\n\t\tvar e = expression(0);\n\t\tadvance(\")\");\n\t\treturn e;\n\t});\n\n\tprefix(\"[\", function () {\n\t\tvar a = [];\n\t\tif (token.id !== \"]\") {\n\t\t\twhile (true) {\n\t\t\t\ta.push(expression(1));\n\t\t\t\tif (token.id !== \",\") {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tadvance(\",\");\n\t\t\t}\n\t\t}\n\t\tadvance(\"]\");\n\t\tthis.first = a;\n\t\tthis.arity = \"unary\";\n\t\treturn this;\n\t});\n\n\tprefix(\"{\", function () {\n\t\tvar a = [],\tn, v;\n\t\tif (token.id !== \"}\") {\n\t\t\twhile (true) {\n\t\t\t\tn = token;\n\t\t\t\tif (n.arity !== \"name\" && n.arity !== \"literal\") {\n\t\t\t\t\terror(\"Bad property name: \", token);\n\t\t\t\t}\n\t\t\t\tadvance();\n\t\t\t\tadvance(\":\");\n\t\t\t\tv = expression(1);\n\t\t\t\tv.key = n.value;\n\t\t\t\ta.push(v);\n\t\t\t\tif (token.id !== \",\") {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tadvance(\",\");\n\t\t\t}\n\t\t}\n\t\tadvance(\"}\");\n\t\tthis.first = a;\n\t\tthis.arity = \"unary\";\n\t\treturn this;\n\t});\n\n\tprefix('new', function () {\n\t\tvar a = [];\n\t\tthis.first = expression(79);\n\t\tif(token.id === '(') {\n\t\t\tadvance(\"(\");\n\t\t\tthis.arity = 'binary';\n\t\t\tthis.second = a;\n\t\t\twhile (true) {\n\t\t\t\ta.push(expression(1));\n\t\t\t\tif (token.id !== \",\") {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tadvance(\",\");\n\t\t\t}\n\t\t\tadvance(\")\");\n\t\t}else{\n\t\t\tthis.arity = \"unary\";\n\t\t}\n\t\treturn this;\n\t});\n\n\t//_source: 表达式代码字符串\n\t//_context: 表达式的语句环境\n\treturn function (_source, _context) {\n    source = _source;\n\t\ttokens = tokenize(_source, '=<>!+-*&|/%^', '=<>&|');\n\t\ttoken_nr = 0;\n\t\tcontext = _context;\n\t\tadvance();\n\t\tvar s = expression(0);\n\t\tadvance(\"(end)\");\n\t\treturn s;\n\t};\n};\n\nexports.parse = make_parse();\n","\"use strict\";\r\n\r\nvar utils = require('./utils');\r\n\r\n//根据变量及 vm 确定变量所属的真正 vm\r\nvar reformScope = function (vm, path) {\r\n  var paths = utils.parseKeyPath(path);\r\n  var cur = vm, local = paths[0];\r\n  var scope = cur, ass, curVm = cur;\r\n\r\n  while(cur) {\r\n    curVm = scope = cur;\r\n    ass = cur._assignments;\r\n    if( cur.__repeat) {\r\n      if (ass && ass.length) {\r\n        // 具名 repeat 不会直接查找自身作用域\r\n        if (local === '$index' || local === '$parent') {\r\n          break;\r\n        } else if (local === ass[0]) {\r\n          scope = {}\r\n          scope[path] = cur.$data\r\n          //修正key\r\n          if (paths.length === 1) {\r\n            local = '$data';\r\n          } else {\r\n            paths.shift()\r\n          }\r\n          break;\r\n        }\r\n      } else {\r\n        //匿名 repeat\r\n        if (path in cur) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    cur = cur.$parent;\r\n  }\r\n\r\n  return { scope: scope, vm:curVm, path: paths.join('.') }\r\n};\r\n\r\n//根据 vm 及 key 求值\r\n//求值的结果在 js 及模板中保持一致\r\nvar getValue = function(key, scope) {\r\n  var reformed = reformScope(scope, key)\r\n\r\n  return reformed.scope[reformed.path]\r\n};\r\n\r\nexports.reformScope = reformScope;\r\nexports.getValue = getValue;\r\n","var tokenReg = /{{({([^}\\n]+)}|[^}\\n]+)}}/g;\n\n//字符串中是否包含模板占位符标记\nfunction hasToken(str) {\n  tokenReg.lastIndex = 0;\n  return str && tokenReg.test(str);\n}\n\nfunction parseToken(value) {\n  var tokens = []\n    , textMap = []\n    , start = 0\n    , val, token\n    ;\n  \n  tokenReg.lastIndex = 0;\n  \n  while((val = tokenReg.exec(value))){\n    if(tokenReg.lastIndex - start > val[0].length){\n      textMap.push(value.slice(start, tokenReg.lastIndex - val[0].length));\n    }\n    \n    token = {\n      escape: !val[2]\n    , path: (val[2] || val[1]).trim()\n    , position: textMap.length\n    , textMap: textMap\n    };\n    \n    tokens.push(token);\n    \n    //一个引用类型(数组)作为节点对象的文本图, 这样当某一个引用改变了一个值后, 其他引用取得的值都会同时更新\n    textMap.push(val[0]);\n    \n    start = tokenReg.lastIndex;\n  }\n  \n  if(value.length > start){\n    textMap.push(value.slice(start, value.length));\n  }\n  \n  tokens.textMap = textMap;\n  \n  return tokens;\n}\n\nexports.hasToken = hasToken;\n\nexports.parseToken = parseToken;","\"use strict\";\n\n//utils\n//---\n\nvar doc = require('./env.js').document;\n\nvar keyPathReg = /(?:\\.|\\[)/g\n  , bra = /\\]/g\n  ;\n\n//将 keyPath 转为数组形式\n//path.key, path[key] --> ['path', 'key']\nfunction parseKeyPath(keyPath){\n  return keyPath.replace(bra, '').split(keyPathReg);\n}\n\n/**\n * 合并对象\n * @static\n * @param {Boolean} [deep=false] 是否深度合并\n * @param {Object} target 目标对象\n * @param {Object} [object...] 来源对象\n * @return {Function} 合并后的 target 对象\n */\nfunction extend(/* deep, target, object... */) {\n  var options\n    , name, src, copy, copyIsArray, clone\n    , target = arguments[0] || {}\n    , i = 1\n    , length = arguments.length\n    , deep = false\n    ;\n\n  // Handle a deep copy situation\n  if (typeof target === \"boolean\") {\n    deep = target;\n\n    // skip the boolean and the target\n    target = arguments[ i ] || {};\n    i++;\n  }\n\n  if(utils.isFunction(arguments[length - 1])) {\n    length--;\n  }\n\n  // Handle case when target is a string or something (possible in deep copy)\n  if (typeof target !== \"object\" && !utils.isFunction(target)) {\n    target = {};\n  }\n\n  for ( ; i < length; i++ ) {\n    // Only deal with non-null/undefined values\n    if ( (options = arguments[ i ]) != null ) {\n      // Extend the base object\n      for ( name in options ) {\n        //android 2.3 browser can enum the prototype of constructor...\n        if(options.hasOwnProperty(name) && name !== 'prototype'){\n          src = target[ name ];\n          copy = options[ name ];\n\n\n          // Recurse if we're merging plain objects or arrays\n          if ( deep && copy && ( utils.isPlainObject(copy) || (copyIsArray = utils.isArray(copy)) ) ) {\n\n            // Prevent never-ending loop\n            if ( target === copy ) {\n              continue;\n            }\n            if ( copyIsArray ) {\n              copyIsArray = false;\n              clone = src && utils.isArray(src) ? src : [];\n\n            } else {\n              clone = src && utils.isPlainObject(src) ? src : {};\n            }\n\n            // Never move original objects, clone them\n            target[ name ] = extend( deep, clone, copy);\n\n            // Don't bring in undefined values\n          } else if ( !utils.isUndefined(copy) && typeof target !== 'string') {\n            //一些情下, 比如 firefox 下给字符串对象赋值时会异常\n            target[name] = copy;\n          }\n        }\n      }\n    }\n  }\n\n  // Return the modified object\n  return target;\n}\n\nvar create = Object.create || function (o) {\n  function F() {}\n  F.prototype = o;\n  return new F();\n};\n\nvar deepGet = function (keyStr, obj) {\n  var chain, cur = obj, key;\n  if(keyStr){\n    chain = parseKeyPath(keyStr);\n    for(var i = 0, l = chain.length; i < l; i++) {\n      key = chain[i];\n      if(cur){\n        cur = cur[key];\n      }else{\n        return;\n      }\n    }\n  }\n  return cur;\n}\n\nvar utils = {\n  noop: function (){}\n, ie: !!doc.attachEvent\n\n, isObject: function (val) {\n    return typeof val === 'object' && val !== null;\n  }\n\n, isUndefined: function (val) {\n    return typeof val === 'undefined';\n  }\n\n, isFunction: function (val){\n    return typeof val === 'function';\n  }\n\n, isArray: function (val) {\n    if(utils.ie){\n      //IE 9 及以下 IE 跨窗口检测数组\n      return val && val.constructor + '' === Array + '';\n    }else{\n      return Array.isArray(val);\n    }\n  }\n\n  //简单对象的简易判断\n, isPlainObject: function (o){\n    if (!o || ({}).toString.call(o) !== '[object Object]' || o.nodeType || o === o.window) {\n      return false;\n    }else{\n      return true;\n    }\n  }\n\n  //函数切面. oriFn 原始函数, fn 切面补充函数\n  //前面的函数返回值传入 breakCheck 判断, breakCheck 返回值为真时不执行切面补充的函数\n, beforeFn: function (oriFn, fn, breakCheck) {\n    return function() {\n      var ret = fn.apply(this, arguments);\n      if(breakCheck && breakCheck.call(this, ret)){\n        return ret;\n      }\n      return oriFn.apply(this, arguments);\n    };\n  }\n\n, afterFn: function (oriFn, fn, breakCheck) {\n    return function() {\n      var ret = oriFn.apply(this, arguments);\n      if(breakCheck && breakCheck.call(this, ret)){\n        return ret;\n      }\n      fn.apply(this, arguments);\n      return ret;\n    }\n  }\n\n, parseKeyPath: parseKeyPath\n\n, deepSet: function (keyStr, value, obj) {\n    if(keyStr){\n      var chain = parseKeyPath(keyStr)\n        , cur = obj\n        ;\n      chain.forEach(function(key, i) {\n        if(i === chain.length - 1){\n          cur[key] = value;\n        }else{\n          if(cur && cur.hasOwnProperty(key)){\n            cur = cur[key];\n          }else{\n            cur[key] = {};\n            cur = cur[key];\n          }\n        }\n      });\n    }else{\n      extend(obj, value);\n    }\n    return obj;\n  }\n, extend: extend\n, create: create\n, toArray: function(arrLike) {\n    var arr = [];\n\n    try{\n      //IE 8 对 dom 对象会报错\n      arr = Array.prototype.slice.call(arrLike)\n    }catch (e){\n      for(var i = 0, l = arrLike.length; i < l; i++) {\n        arr[i] = arrLike[i]\n      }\n    }\n    return arr;\n  }\n};\n\nmodule.exports = utils;\n","\"use strict\";\n\nvar evaluate = require('./eval.js')\n  , utils = require('./utils.js')\n  , parse = require('./parse.js').parse\n  , reformScope = require('./scope').reformScope\n  ;\n\nfunction Watcher(vm, dir) {\n  var reformed, path, curVm = vm, watchers = [];\n\n  this.state = 1;\n  this.dir = dir;\n  this.vm = vm;\n  this.watchers = [];\n\n  this.val = NaN;\n\n  dir.parse();\n  dir.summary = evaluate.summary(dir.ast);\n\n  for(var i = 0, l = dir.summary.paths.length; i < l; i++) {\n    reformed = reformScope(vm, dir.summary.paths[i])\n    curVm = reformed.vm\n    path = reformed.path\n    if(dir.watch) {\n      curVm._watchers[path] = curVm._watchers[path] || [];\n      curVm._watchers[path].push(this);\n      watchers = curVm._watchers[path];\n    }else{\n      watchers = [this];\n    }\n    this.watchers.push( watchers );\n  }\n\n  this.update();\n}\n\n//根据表达式移除当前 vm 中的 watcher\nfunction unwatch (vm, exp, callback) {\n  var summary;\n  try {\n    summary = evaluate.summary(parse(exp))\n  }catch (e){\n    e.message = 'SyntaxError in \"' + exp + '\" | ' + e.message;\n    console.error(e);\n  }\n  summary.paths.forEach(function(path) {\n    var watchers = vm._watchers[path] || [], update;\n\n    for(var i = watchers.length - 1; i >= 0; i--){\n      update = watchers[i].dir.update;\n      if(update === callback || update._originFn === callback){\n        watchers.splice(i, 1);\n      }\n    }\n  })\n}\n\nfunction addWatcher(dir) {\n  if(dir.path) {\n    return new Watcher(this, dir);\n  }\n}\n\nWatcher.unwatch = unwatch;\nWatcher.addWatcher = addWatcher;\n\nfunction watcherUpdate (val) {\n  try{\n    this.dir.update(val, this.val);\n    this.val = val;\n  }catch(e){\n    console.error(e);\n  }\n}\n\nutils.extend(Watcher.prototype, {\n  //表达式执行\n  update: function() {\n    var that = this\n      , newVal\n      ;\n\n    newVal = this.dir.getValue(this.vm);\n\n    if(newVal && newVal.then) {\n      //a promise\n      newVal.then(function(val) {\n        watcherUpdate.call(that, val);\n      });\n    }else{\n      watcherUpdate.call(this, newVal);\n    }\n  },\n  unwatch: function() {\n    this.watchers.forEach(function(watchers) {\n      for(var i = watchers.length - 1; i >= 0; i--){\n        if(watchers[i] === this){\n          if(this.state){\n            watchers[i].dir.unLink();\n            this.state = 0;\n          }\n          watchers.splice(i, 1);\n        }\n      }\n    }.bind(this))\n    this.watchers = [];\n  }\n});\n\nmodule.exports = Watcher\n"],"sourceRoot":"./"}